import{j as e}from"./vendor-motion-_XdJ9pBm.js";import{f as B,u as A,r as i}from"./vendor-react-B4msnGgW.js";import{u as J,b as O,e as M,s,f as j,n as P,l as _}from"./vendor-forms-BxTF4-4_.js";import{s as N,L as v,i as H,B as w,a as G,C as z,e as Q,O as V,n as Y,r as $,F as S,J as K}from"./index-BbSeE-q4.js";import{I as W}from"./ImageUpload-BQtfBKk6.js";import{I as X}from"./image-kEimRz0x.js";import{B as Z}from"./building-2-B7dH_DvY.js";import{I as ee}from"./indian-rupee-CtMJjFIv.js";import{G as re}from"./graduation-cap-C94epHPK.js";import{E as ae}from"./external-link-CSmvpDBS.js";import{S as te}from"./save-CEu7G9Ms.js";import"./vendor-pdf-B1igRwBP.js";import"./vendor-supabase-B_87WqdG.js";import"./upload-CurydzNZ.js";const se=O({company_name:s().min(1,"Company name is required"),company_logo_url:s().url("Must be a valid URL").optional().or(_("")),role_title:s().min(1,"Role title is required"),package_amount:P().positive("Package amount must be positive").optional(),package_type:j(["CTC","stipend","hourly"]).optional(),domain:s().min(1,"Domain is required"),location_type:j(["Remote","Onsite","Hybrid"]),location_city:s().optional(),experience_required:s().min(1,"Experience requirement is required"),qualification:s().min(1,"Qualification is required"),eligible_years:s().optional().or(_("")),short_description:s().min(50,"Short description must be at least 50 characters"),full_description:s().min(100,"Full description must be at least 100 characters"),application_link:s().url("Must be a valid URL"),is_active:M().default(!0)}),fe=()=>{const{jobId:o}=B(),d=A(),[C,u]=i.useState(!0),[c,p]=i.useState(!1),[b,m]=i.useState(null),[q,g]=i.useState(!1),[y,x]=i.useState(""),[ie,L]=i.useState(""),{register:t,handleSubmit:T,reset:E,watch:I,setValue:k,formState:{errors:a,isDirty:h}}=J({resolver:K(se)}),D=I("location_type");i.useEffect(()=>{o&&R()},[o]);const R=async()=>{if(o){u(!0);try{const{data:r,error:l}=await N.from("job_listings").select("*").eq("id",o).single();if(l)throw l;r&&(E({company_name:r.company_name,company_logo_url:r.company_logo_url||"",role_title:r.role_title,package_amount:r.package_amount||void 0,package_type:r.package_type||"CTC",domain:r.domain,location_type:r.location_type,location_city:r.location_city||"",experience_required:r.experience_required,qualification:r.qualification,eligible_years:r.eligible_years||"",short_description:r.short_description,full_description:r.full_description,application_link:r.application_link,is_active:r.is_active}),x(r.company_logo_url||""),L(r.company_logo_url||""))}catch(r){console.error("Error fetching job:",r),m("Failed to load job data")}finally{u(!1)}}},F=async r=>{var l;if(o){p(!0),m(null),g(!1);try{const n={company_name:r.company_name,company_logo_url:y||r.company_logo_url||null,role_title:r.role_title,package_amount:r.package_amount||null,package_type:r.package_type||null,domain:r.domain,location_type:r.location_type,location_city:r.location_city||null,experience_required:r.experience_required,qualification:r.qualification,eligible_years:(l=r.eligible_years)!=null&&l.trim()?r.eligible_years.trim():null,short_description:r.short_description,full_description:r.full_description,application_link:r.application_link,is_active:r.is_active,updated_at:new Date().toISOString()},{error:f}=await N.from("job_listings").update(n).eq("id",o);if(f)throw f;g(!0),setTimeout(()=>{d("/admin/jobs")},1500)}catch(n){m(n instanceof Error?n.message:"Failed to update job listing")}finally{p(!1)}}},U=["SDE","Data Science","Product","Design","Marketing","Sales","Analytics","AI","DevOps","Mobile","Frontend","Backend","Full-Stack","QA","Content","HR","Finance","Operations"];return C?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-12 h-12 text-blue-600 dark:text-neon-cyan-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading job data..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 lg:pl-16 transition-colors duration-300",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40 dark:bg-dark-50 dark:border-dark-300",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex items-center justify-between h-16 py-3",children:[e.jsxs("button",{onClick:()=>d("/admin/jobs"),className:"lg:hidden bg-gradient-to-r from-neon-cyan-500 to-neon-blue-500 text-white hover:from-neon-cyan-400 hover:to-neon-blue-400 py-3 px-5 rounded-xl inline-flex items-center space-x-2 transition-all duration-200",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:block",children:"Back to Jobs"})]}),e.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Edit Job Listing"}),e.jsx("div",{className:"w-24"})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden dark:bg-dark-100 dark:border-dark-300",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 border-b border-gray-200 dark:from-dark-200 dark:to-dark-300 dark:border-dark-400",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 flex items-center",children:[e.jsx(w,{className:"w-5 h-5 mr-2 text-blue-600 dark:text-neon-cyan-400"}),"Edit Job Details"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Update the job listing information"})]}),e.jsxs("form",{onSubmit:T(F),className:"p-6 space-y-6",children:[b&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl dark:bg-red-900/20 dark:border-red-500/50",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(G,{className:"w-5 h-5 text-red-600 dark:text-red-400 mr-3 mt-0.5"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm font-medium",children:b})]})}),q&&e.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-xl dark:bg-neon-cyan-500/10 dark:border-neon-cyan-400/50",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(z,{className:"w-5 h-5 text-green-600 dark:text-neon-cyan-400 mr-3 mt-0.5"}),e.jsx("p",{className:"text-green-700 dark:text-neon-cyan-300 text-sm font-medium",children:"Job listing updated successfully! Redirecting..."})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-dark-200 dark:to-dark-300 p-6 rounded-xl border border-blue-100 dark:border-dark-400",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center",children:[e.jsx(X,{className:"w-5 h-5 mr-2 text-blue-600 dark:text-neon-cyan-400"}),"Company Branding"]}),e.jsx(W,{currentImageUrl:y,onImageUploaded:r=>{x(r),k("company_logo_url",r)},onImageRemoved:()=>{x(""),k("company_logo_url","")}})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Z,{className:"w-4 h-4 inline mr-1"}),"Company Name *"]}),e.jsx("input",{type:"text",...t("company_name"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., Google, Microsoft, Startup Inc."}),a.company_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.company_name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(w,{className:"w-4 h-4 inline mr-1"}),"Role Title *"]}),e.jsx("input",{type:"text",...t("role_title"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., Senior Software Engineer"}),a.role_title&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.role_title.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Q,{className:"w-4 h-4 inline mr-1"}),"Domain *"]}),e.jsxs("select",{...t("domain"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Select Domain"}),U.map(r=>e.jsx("option",{value:r,children:r},r))]}),a.domain&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.domain.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 inline mr-1"}),"Package Amount"]}),e.jsx("input",{type:"number",...t("package_amount",{valueAsNumber:!0}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., 1200000",min:"0"}),a.package_amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.package_amount.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Package Type"}),e.jsxs("select",{...t("package_type"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",children:[e.jsx("option",{value:"CTC",children:"CTC (Annual)"}),e.jsx("option",{value:"stipend",children:"Stipend (Monthly)"}),e.jsx("option",{value:"hourly",children:"Hourly Rate"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(V,{className:"w-4 h-4 inline mr-1"}),"Location Type *"]}),e.jsxs("select",{...t("location_type"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",children:[e.jsx("option",{value:"Remote",children:"Remote"}),e.jsx("option",{value:"Onsite",children:"Onsite"}),e.jsx("option",{value:"Hybrid",children:"Hybrid"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"City"}),e.jsx("input",{type:"text",...t("location_city"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., Bangalore",disabled:D==="Remote"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Y,{className:"w-4 h-4 inline mr-1"}),"Experience *"]}),e.jsx("input",{type:"text",...t("experience_required"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., 0-2 years"}),a.experience_required&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.experience_required.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(re,{className:"w-4 h-4 inline mr-1"}),"Qualification *"]}),e.jsx("input",{type:"text",...t("qualification"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., B.Tech"}),a.qualification&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.qualification.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx($,{className:"w-4 h-4 inline mr-1"}),"Eligible Graduation Years"]}),e.jsx("input",{type:"text",...t("eligible_years"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"e.g., 2024, 2025, 2026"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Mention the graduation batches that can apply. Separate multiple years with commas."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(S,{className:"w-4 h-4 inline mr-1"}),"Short Description *"]}),e.jsx("textarea",{...t("short_description"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-24 resize-none dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"Brief overview (50+ characters)"}),a.short_description&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.short_description.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(S,{className:"w-4 h-4 inline mr-1"}),"Full Description *"]}),e.jsx("textarea",{...t("full_description"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-40 resize-none dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"Complete job description (100+ characters)"}),a.full_description&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.full_description.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(ae,{className:"w-4 h-4 inline mr-1"}),"Application Link *"]}),e.jsx("input",{type:"url",...t("application_link"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-dark-200 dark:border-dark-300 dark:text-gray-100",placeholder:"https://company.com/careers/apply"}),a.application_link&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.application_link.message})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",...t("is_active"),id:"is_active",className:"form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Job is active and accepting applications"})]}),e.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200 dark:border-dark-300",children:[e.jsx("button",{type:"button",onClick:()=>d("/admin/jobs"),className:"bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-xl transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c||!h,className:`font-semibold py-3 px-8 rounded-xl transition-all duration-300 flex items-center space-x-2 ${c||!h?"bg-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Updating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-5 h-5"}),e.jsx("span",{children:"Update Job"})]})})]})]})]})})})]})};export{fe as JobEditPage};
