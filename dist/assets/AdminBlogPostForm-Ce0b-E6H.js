import{j as e}from"./vendor-motion-_XdJ9pBm.js";import{u as G,f as K,r as i}from"./vendor-react-B4msnGgW.js";import{u as Q,b as X,d as F,s as l,f as Z,l as ee}from"./vendor-forms-BxTF4-4_.js";import{c as te,L,i as re,F as B,a as se,C as ae,E as le,r as de,J as oe}from"./index-BbSeE-q4.js";import{a as x}from"./adminBlogService-CrbxTU7H.js";import{b as ie}from"./blogService-soXAcHLk.js";import{T as f}from"./type-Cez_liJx.js";import{L as ne}from"./link-XSUKRoOO.js";import{I as ce}from"./image-kEimRz0x.js";import{F as me}from"./folder-open-CIgGjE_j.js";import{T as xe}from"./tag-DQBqne1U.js";import{S as ge}from"./save-CEu7G9Ms.js";import"./vendor-pdf-B1igRwBP.js";import"./vendor-supabase-B_87WqdG.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=te("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]),ue=X({title:l().min(1,"Title is required").max(200,"Title must be less than 200 characters"),slug:l().min(1,"Slug is required").regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/,"Slug must be lowercase with hyphens"),excerpt:l().max(500,"Excerpt must be less than 500 characters").optional(),body_content:l().min(100,"Body content must be at least 100 characters"),featured_image_url:l().url("Must be a valid URL").optional().or(ee("")),author_name:l().optional(),status:Z(["draft","published","scheduled"]),published_at:l().optional(),meta_title:l().max(60,"Meta title should be less than 60 characters").optional(),meta_description:l().max(160,"Meta description should be less than 160 characters").optional(),category_ids:F(l()).optional(),tag_ids:F(l()).optional()}),Ee=()=>{const g=G(),{id:c}=K(),d=!!c,[y,k]=i.useState(!1),[M,j]=i.useState(d),[N,u]=i.useState(null),[I,w]=i.useState(!1),[O,U]=i.useState([]),[R,D]=i.useState([]),[v,_]=i.useState([]),[S,T]=i.useState([]),{register:o,handleSubmit:V,formState:{errors:a},setValue:m,watch:b,reset:$}=Q({resolver:oe(ue),defaultValues:{status:"draft",category_ids:[],tag_ids:[]}}),p=b("title"),q=b("status"),C=b("featured_image_url");i.useEffect(()=>{z(),d&&c&&H(c)},[c,d]),i.useEffect(()=>{if(p&&!d){const t=ie.generateSlug(p);m("slug",t)}},[p,d,m]);const z=async()=>{try{const[t,s]=await Promise.all([x.fetchAllCategories(),x.fetchAllTags()]);U(t),D(s)}catch(t){console.error("Error loading categories and tags:",t)}},H=async t=>{var s,n;try{j(!0);const r=await x.fetchPostById(t);if(r){$({title:r.title,slug:r.slug,excerpt:r.excerpt||"",body_content:r.body_content,featured_image_url:r.featured_image_url||"",author_name:r.author_name||"",status:r.status,published_at:r.published_at||"",meta_title:r.meta_title||"",meta_description:r.meta_description||""});const E=((s=r.categories)==null?void 0:s.map(h=>h.id))||[],P=((n=r.tags)==null?void 0:n.map(h=>h.id))||[];_(E),T(P),m("category_ids",E),m("tag_ids",P)}}catch(r){console.error("Error loading blog post:",r),u("Failed to load blog post")}finally{j(!1)}},J=async t=>{try{k(!0),u(null),w(!1);const s={...t,category_ids:v,tag_ids:S};d&&c?await x.updateBlogPost({id:c,...s}):await x.createBlogPost(s),w(!0),setTimeout(()=>{g("/admin/blog")},1500)}catch(s){console.error("Error saving blog post:",s),u(s.message||"Failed to save blog post")}finally{k(!1)}},W=t=>{_(s=>{const n=s.includes(t)?s.filter(r=>r!==t):[...s,t];return m("category_ids",n),n})},Y=t=>{T(s=>{const n=s.includes(t)?s.filter(r=>r!==t):[...s,t];return m("tag_ids",n),n})};return M?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 py-12 px-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-lg p-8 text-center",children:[e.jsx(L,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading blog post..."})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 py-12 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>g("/admin/blog"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100 transition-colors",children:[e.jsx(re,{className:"w-4 h-4"}),"Back to Blog Posts"]})}),e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-lg border border-gray-200 dark:border-dark-300 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:d?"Edit Blog Post":"Create New Blog Post"}),e.jsx("p",{className:"text-blue-100 text-sm mt-1",children:d?"Update your blog post details":"Fill in all the details below"})]})]})}),N&&e.jsxs("div",{className:"m-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(se,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-800 dark:text-red-200",children:"Error"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:N})]})]}),I&&e.jsxs("div",{className:"m-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ae,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-green-800 dark:text-green-200",children:"Success!"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300 mt-1",children:["Blog post ",d?"updated":"created"," successfully. Redirecting..."]})]})]}),e.jsxs("form",{onSubmit:V(J),className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Title (Heading) *"]}),e.jsx("input",{...o("title"),type:"text",className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"Enter blog post title"}),a.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.title.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Slug (URL) *"]}),e.jsx("input",{...o("slug"),type:"text",className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"blog-post-slug"}),a.slug&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.slug.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Featured Image URL"]}),e.jsx("input",{...o("featured_image_url"),type:"url",className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"https://example.com/image.jpg"}),a.featured_image_url&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.featured_image_url.message}),C&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:C,alt:"Preview",className:"w-full h-48 object-cover rounded-lg border border-gray-200 dark:border-dark-400",onError:t=>{t.currentTarget.style.display="none"}})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Excerpt (Short Summary)"]}),e.jsx("textarea",{...o("excerpt"),rows:3,className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"Brief description of the blog post"}),a.excerpt&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.excerpt.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Body Content (Full Article) *"]}),e.jsx("textarea",{...o("body_content"),rows:15,className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100 font-mono text-sm",placeholder:"Write your full blog post content here. You can use HTML or plain text."}),a.body_content&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.body_content.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Status *"]}),e.jsxs("select",{...o("status"),className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"scheduled",children:"Scheduled"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Published Date ",q==="scheduled"&&"*"]}),e.jsx("input",{...o("published_at"),type:"datetime-local",className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Author Name"]}),e.jsx("input",{...o("author_name"),type:"text",className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"Author name (defaults to admin email)"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Categories"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:O.map(t=>e.jsx("button",{type:"button",onClick:()=>W(t.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${v.includes(t.id)?"bg-blue-600 text-white":"bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-300"}`,children:t.name},t.id))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Tags"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:R.map(t=>e.jsx("button",{type:"button",onClick:()=>Y(t.id),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${S.includes(t.id)?"bg-green-600 text-white":"bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-300"}`,children:t.name},t.id))})]}),e.jsx("div",{className:"md:col-span-2 border-t border-gray-200 dark:border-dark-300 pt-6",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"SEO Settings"})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Meta Title (SEO)"]}),e.jsx("input",{...o("meta_title"),type:"text",className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"SEO title (defaults to post title)"}),a.meta_title&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.meta_title.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Meta Description (SEO)"]}),e.jsx("textarea",{...o("meta_description"),rows:2,className:"w-full px-4 py-3 border border-gray-300 dark:border-dark-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-dark-200 dark:text-gray-100",placeholder:"SEO description (defaults to excerpt)"}),a.meta_description&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.meta_description.message})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200 dark:border-dark-300",children:[e.jsx("button",{type:"submit",disabled:y,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-5 h-5"}),d?"Update Post":"Create Post"]})}),e.jsx("button",{type:"button",onClick:()=>g("/admin/blog"),className:"px-6 py-3 border border-gray-300 dark:border-dark-400 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-200 transition-colors",children:"Cancel"})]})]})]})]})})};export{Ee as AdminBlogPostForm};
