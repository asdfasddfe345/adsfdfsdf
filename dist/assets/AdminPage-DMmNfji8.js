import{_ as Te}from"./vendor-pdf-B1igRwBP.js";import{j as e}from"./vendor-motion-_XdJ9pBm.js";import{r as m}from"./vendor-react-B4msnGgW.js";import{s as S}from"./supabase-DdGTG0kf.js";import{c as te,R as $,C as H,m as Q,T as W,f as Fe,r as ue,n as V,a as xe,$ as Le,E as ge,X as Y,a0 as se,g as re,B as ce,O as Me,h as Ue,e as Je,M as Ie,Q as $e}from"./index-BbSeE-q4.js";import{P as B}from"./plus-C66eGFjH.js";import{X as G}from"./x-circle-ytsTtMRB.js";import{P as he,S as Re}from"./star-off-CQ3zi2b6.js";import{D as ee}from"./database-BUKIZYYv.js";import{j as I,B as pe}from"./jobUpdatesService-uAKDJqBS.js";import{S as ie}from"./star-DBKesPgG.js";import{E as Oe}from"./external-link-CSmvpDBS.js";import{S as qe}from"./search-DiwtcWwp.js";import{D as ze}from"./download-DWlYtjQA.js";import{Z as Qe}from"./zap-BGmE2sY4.js";import{S as Be}from"./settings-BIk3p6dz.js";import{P as ye}from"./play-BW95sg1B.js";import{D as He}from"./dollar-sign-DGh0A-Eb.js";import{S as de}from"./square-pen-CSgRhjVa.js";import{T as Ve}from"./tag-DQBqne1U.js";import{S as ae}from"./save-CEu7G9Ms.js";import{C as We}from"./code-GxPtUTRK.js";import"./vendor-supabase-B_87WqdG.js";import"./vendor-forms-BxTF4-4_.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=te("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=te("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=te("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=te("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),J={async getQuestions(){try{const t=new Promise((a,i)=>{setTimeout(()=>i(new Error("Database timeout")),3e3)}),s=S.from("questions").select("*").order("created_at",{ascending:!1}),{data:r,error:n}=await Promise.race([s,t]);if(n)throw n;return(r||[]).map(a=>({id:a.id,company:a.company,role:a.role,category:a.category,difficulty:a.difficulty,questionText:a.question_text,solutionText:a.solution_text,codeExample:a.code_example,explanation:a.explanation,tags:a.tags||[],imageUrl:a.image_url,price:a.price||0,createdAt:new Date(a.created_at||""),updatedAt:new Date(a.updated_at||"")}))}catch(t){return console.error("Error fetching questions:",t),[]}},async saveQuestion(t){try{console.log("Saving question to database:",t);const s=new Promise((i,u)=>{setTimeout(()=>u(new Error("Save timeout")),3e3)}),r=S.from("questions").insert({company:t.company,role:t.role,category:t.category,difficulty:t.difficulty,question_text:t.questionText,solution_text:t.solutionText,code_example:t.codeExample,explanation:t.explanation,tags:t.tags,image_url:t.imageUrl,price:t.price||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single(),{data:n,error:a}=await Promise.race([r,s]);if(console.log("Database response:",{data:n,error:a}),a)throw a;if(!n)throw new Error("No data returned from database");return{id:n.id,company:n.company,role:n.role,category:n.category,difficulty:n.difficulty,questionText:n.question_text,solutionText:n.solution_text,codeExample:n.code_example,explanation:n.explanation,tags:n.tags||[],imageUrl:n.image_url,price:n.price||0,createdAt:new Date(n.created_at||""),updatedAt:new Date(n.updated_at||"")}}catch(s){return console.error("Error saving question:",s),null}},async updateQuestion(t,s){try{console.log("Updating question in database:",t,s);const r=new Promise((u,p)=>{setTimeout(()=>p(new Error("Update timeout")),3e3)}),n=S.from("questions").update({company:s.company,role:s.role,category:s.category,difficulty:s.difficulty,question_text:s.questionText,solution_text:s.solutionText,code_example:s.codeExample,explanation:s.explanation,tags:s.tags,image_url:s.imageUrl,price:s.price,updated_at:new Date().toISOString()}).eq("id",t).select().single(),{data:a,error:i}=await Promise.race([n,r]);if(console.log("Update response:",{data:a,error:i}),i)throw i;if(!a)throw new Error("No data returned from database");return{id:a.id,company:a.company,role:a.role,category:a.category,difficulty:a.difficulty,questionText:a.question_text,solutionText:a.solution_text,codeExample:a.code_example,explanation:a.explanation,tags:a.tags||[],imageUrl:a.image_url,price:a.price||0,createdAt:new Date(a.created_at||""),updatedAt:new Date(a.updated_at||"")}}catch(r){return console.error("Error updating question:",r),null}},async deleteQuestion(t){try{console.log("Deleting question from database:",t);const s=new Promise((a,i)=>{setTimeout(()=>i(new Error("Delete timeout")),3e3)}),r=S.from("questions").delete().eq("id",t),{error:n}=await Promise.race([r,s]);if(console.log("Delete response:",{error:n}),n)throw n;return!0}catch(s){return console.error("Error deleting question:",s),!1}},async getAccessLogs(t){try{const s=new Promise((i,u)=>{setTimeout(()=>u(new Error("Access logs timeout")),3e3)});let r=S.from("access_logs").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("user_id",t));const{data:n,error:a}=await Promise.race([r,s]);if(a)throw a;return(n||[]).map(i=>({id:i.id,userId:i.user_id,questionId:i.question_id,accessStartTime:new Date(i.access_start_time),accessExpiryTime:new Date(i.access_expiry_time),paymentStatus:i.payment_status,paymentId:i.payment_id,amountPaid:i.amount_paid}))}catch(s){return console.error("Error fetching access logs:",s),[]}},async saveAccessLog(t){try{const s=new Promise((i,u)=>{setTimeout(()=>u(new Error("Save access log timeout")),3e3)}),r=S.from("access_logs").insert({user_id:t.userId,question_id:t.questionId,access_start_time:t.accessStartTime.toISOString(),access_expiry_time:t.accessExpiryTime.toISOString(),payment_status:t.paymentStatus,payment_id:t.paymentId,amount_paid:t.amountPaid,created_at:new Date().toISOString()}).select().single(),{data:n,error:a}=await Promise.race([r,s]);if(a)throw a;return{id:n.id,userId:n.user_id,questionId:n.question_id,accessStartTime:new Date(n.access_start_time),accessExpiryTime:new Date(n.access_expiry_time),paymentStatus:n.payment_status,paymentId:n.payment_id,amountPaid:n.amount_paid}}catch(s){return console.error("Error saving access log:",s),null}},async getMaterials(){try{const t=new Promise((a,i)=>{setTimeout(()=>i(new Error("Materials timeout")),3e3)}),s=S.from("materials").select("*").order("uploaded_at",{ascending:!1}),{data:r,error:n}=await Promise.race([s,t]);if(n)throw n;return(r||[]).map(a=>({id:a.id,title:a.title,description:a.description,category:a.category,company:a.company,role:a.role,content:a.content,imageUrl:a.image_url,uploadedAt:new Date(a.uploaded_at||"")}))}catch(t){return console.error("Error fetching materials:",t),[]}},async saveMaterial(t){try{console.log("Saving material to database:",t);const s=new Promise((i,u)=>{setTimeout(()=>u(new Error("Save material timeout")),3e3)}),r=S.from("materials").insert({title:t.title,description:t.description,category:t.category,company:t.company,role:t.role,content:t.content,image_url:t.imageUrl,uploaded_at:new Date().toISOString()}).select().single(),{data:n,error:a}=await Promise.race([r,s]);if(console.log("Material save response:",{data:n,error:a}),a)throw a;if(!n)throw new Error("No data returned from database");return{id:n.id,title:n.title,description:n.description,category:n.category,company:n.company,role:n.role,content:n.content,imageUrl:n.image_url,uploadedAt:new Date(n.uploaded_at||"")}}catch(s){return console.error("Error saving material:",s),null}},async updateMaterial(t,s){try{const r=new Promise((u,p)=>{setTimeout(()=>p(new Error("Update material timeout")),3e3)}),n=S.from("materials").update({title:s.title,description:s.description,category:s.category,company:s.company,role:s.role,content:s.content,image_url:s.imageUrl}).eq("id",t).select().single(),{data:a,error:i}=await Promise.race([n,r]);if(i)throw i;return{id:a.id,title:a.title,description:a.description,category:a.category,company:a.company,role:a.role,content:a.content,imageUrl:a.image_url,uploadedAt:new Date(a.uploaded_at||"")}}catch(r){return console.error("Error updating material:",r),null}},async deleteMaterial(t){try{const s=new Promise((a,i)=>{setTimeout(()=>i(new Error("Delete material timeout")),3e3)}),r=S.from("materials").delete().eq("id",t),{error:n}=await Promise.race([r,s]);if(n)throw n;return!0}catch(s){return console.error("Error deleting material:",s),!1}},async getPaymentSettings(){try{const t=new Promise((a,i)=>{setTimeout(()=>i(new Error("Payment settings timeout")),3e3)}),s=S.from("payment_settings").select("*").limit(1).single(),{data:r,error:n}=await Promise.race([s,t]);return n?{basePrice:49,currency:"INR",activeCoupons:[{code:"FREE100",discount:100,description:"Free access"},{code:"HALF50",discount:50,description:"50% off"},{code:"SAVE20",discount:20,description:"20% discount"}]}:{basePrice:r.base_price,currency:r.currency,activeCoupons:r.active_coupons||[]}}catch(t){return console.error("Error fetching payment settings:",t),{basePrice:49,currency:"INR",activeCoupons:[]}}},async savePaymentSettings(t){try{console.log("Saving payment settings to database:",t);const s=new Promise((a,i)=>{setTimeout(()=>i(new Error("Save payment settings timeout")),3e3)}),r=S.from("payment_settings").upsert({id:"1",base_price:t.basePrice,currency:t.currency,active_coupons:t.activeCoupons,updated_at:new Date().toISOString()}),{error:n}=await Promise.race([r,s]);if(console.log("Payment settings save response:",{error:n}),n)throw n;return!0}catch(s){return console.error("Error saving payment settings:",s),!1}},async getUserProfile(t){try{const s=new Promise((i,u)=>{setTimeout(()=>u(new Error("User profile timeout")),3e3)}),r=S.from("users").select("*").eq("id",t).single(),{data:n,error:a}=await Promise.race([r,s]);if(a)throw a;return n}catch(s){return console.error("Error fetching user profile:",s),null}},async updateUserProfile(t,s){try{const r=new Promise((i,u)=>{setTimeout(()=>u(new Error("Update profile timeout")),3e3)}),n=S.from("users").update(s).eq("id",t),{error:a}=await Promise.race([n,r]);if(a)throw a;return!0}catch(r){return console.error("Error updating user profile:",r),!1}}};class je{async getConfigs(){const{data:s,error:r}=await S.from("job_fetch_configs").select("*").order("created_at",{ascending:!1});if(r)throw r;return s||[]}async getConfigById(s){const{data:r,error:n}=await S.from("job_fetch_configs").select("*").eq("id",s).maybeSingle();if(n)throw n;return r}async createConfig(s){var i;const{data:r}=await S.auth.getUser(),{data:n,error:a}=await S.from("job_fetch_configs").insert({...s,created_by:(i=r==null?void 0:r.user)==null?void 0:i.id}).select().single();if(a)throw a;return n}async updateConfig(s,r){const{data:n,error:a}=await S.from("job_fetch_configs").update(r).eq("id",s).select().single();if(a)throw a;return n}async deleteConfig(s){const{error:r}=await S.from("job_fetch_configs").delete().eq("id",s);if(r)throw r}async toggleConfig(s,r){return this.updateConfig(s,{is_active:r})}async getSyncLogs(s,r=50){let n=S.from("job_sync_logs").select("*").order("created_at",{ascending:!1}).limit(r);s&&(n=n.eq("config_id",s));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async triggerManualSync(s){var r;try{const n=await this.getConfigById(s);if(!n)throw new Error("Configuration not found");if(!n.is_active)throw new Error("Configuration is not active");const{data:a,error:i}=await S.functions.invoke("apify-sync-jobs",{body:{configId:s}});if(i)throw i;const u=(r=a==null?void 0:a.results)==null?void 0:r[0];return u!=null&&u.success&&(u!=null&&u.stats)?{success:!0,message:`Sync completed: ${u.stats.fetched} fetched, ${u.stats.created} created, ${u.stats.updated} updated`,stats:u.stats,platform:u.platform}:u&&!u.success?{success:!1,message:u.error||"Sync failed",platform:u.platform}:{success:!0,message:"Sync initiated successfully"}}catch(n){return{success:!1,message:n instanceof Error?n.message:"Failed to trigger sync"}}}generateDefaultSearchConfig(s){return{linkedin:{keywords:["software engineer","developer"],location:"India",jobType:"Full-time",experienceLevel:"Entry level",maxResults:50},indeed:{keywords:["software developer"],location:"Remote",jobType:"Full-time",maxResults:50},naukri:{keywords:["software engineer"],location:"Bangalore",experienceLevel:"0-3 years",maxResults:50},instahyre:{keywords:["backend developer","frontend developer"],location:"India",maxResults:50}}[s.toLowerCase()]||{keywords:["software"],location:"India",maxResults:50}}generateFresherConfig(){return{aiEmploymentTypeFilter:["FULL_TIME","INTERN"],aiExperienceLevelFilter:["0-2"],aiHasSalary:!0,aiVisaSponsorshipFilter:!1,ats:["workday","greenhouse","lever.co","smartrecruiters","successfactors","zoho"],includeAi:!0,includeLinkedIn:!1,locationSearch:["India"],maxJobs:10,populateAiRemoteLocation:!1,populateAiRemoteLocationDerived:!1,"remote only (legacy)":!1,timeRange:"6m",titleExclusionSearch:["Senior","Lead","Manager","Director","VP","Head","Principal","Architect"],titleSearch:["Software Engineer","Software Developer","Associate Software Engineer","Graduate Engineer","Trainee Software Engineer","Software Intern","Engineering Intern","Developer Intern"]}}generateCustomFresherConfig(s){const r=this.generateFresherConfig();return{...r,maxJobs:s.maxJobs||r.maxJobs,locationSearch:s.locations||r.locationSearch,titleSearch:[...r.titleSearch,...s.additionalTitles||[]],"remote only (legacy)":s.includeRemote||!1,timeRange:s.timeRange||r.timeRange}}getPopularActorIds(){return{linkedin:"apify/linkedin-jobs-scraper",indeed:"apify/indeed-scraper",naukri:"curious_coder/naukri-scraper",instahyre:"apify/instahyre-scraper",glassdoor:"apify/glassdoor-scraper"}}async testApifyConnection(s,r){try{if(!(await fetch(`https://api.apify.com/v2/acts/${r}`,{headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Invalid API token or Actor ID");return{success:!0,message:"Connection successful"}}catch(n){return{success:!1,message:n instanceof Error?n.message:"Connection failed"}}}async getActiveConfigs(){const{data:s,error:r}=await S.from("job_fetch_configs").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(r)throw r;return s||[]}async getDefaultConfig(){const{data:s,error:r}=await S.from("job_fetch_configs").select("*").eq("is_active",!0).order("created_at",{ascending:!0}).limit(1).maybeSingle();if(r)throw r;return s}async triggerDefaultSync(){var s;try{const r=await this.getDefaultConfig();if(!r)throw new Error("No active configuration found. Please add a configuration first.");const{data:n,error:a}=await S.functions.invoke("apify-sync-jobs",{body:{configId:r.id}});if(a)throw a;const i=(s=n==null?void 0:n.results)==null?void 0:s[0];return i!=null&&i.success&&(i!=null&&i.stats)?{success:!0,message:`Sync completed: ${i.stats.fetched} fetched, ${i.stats.created} created, ${i.stats.updated} updated`,config:r,stats:i.stats}:i&&!i.success?{success:!1,message:i.error||"Sync failed",config:r}:{success:!0,message:"Sync initiated successfully",config:r}}catch(r){return{success:!1,message:r instanceof Error?r.message:"Failed to trigger sync"}}}async getSyncStats(){var a;const{data:s,error:r}=await S.from("job_sync_logs").select("*");if(r)throw r;return{totalSyncs:(s==null?void 0:s.length)||0,successfulSyncs:(s==null?void 0:s.filter(i=>i.status==="success").length)||0,failedSyncs:(s==null?void 0:s.filter(i=>i.status==="failed").length)||0,totalJobsFetched:(s==null?void 0:s.reduce((i,u)=>i+(u.jobs_fetched||0),0))||0,totalJobsCreated:(s==null?void 0:s.reduce((i,u)=>i+(u.jobs_created||0),0))||0,lastSyncDate:((a=s==null?void 0:s[0])==null?void 0:a.created_at)||null}}formatSearchConfigForDisplay(s){return Object.entries(s).filter(([n,a])=>a!=null).map(([n,a])=>{const i=n.replace(/([A-Z])/g," $1").toLowerCase(),u=Array.isArray(a)?a.join(", "):a;return`${i}: ${u}`}).join(" | ")}validateSearchConfig(s){const r=[];return(!s.keywords||s.keywords.length===0)&&r.push("At least one keyword is required"),s.maxResults&&(s.maxResults<1||s.maxResults>1e3)&&r.push("Max results must be between 1 and 1000"),{valid:r.length===0,errors:r}}async getScheduledSyncs(){const{data:s,error:r}=await S.from("apify_scheduled_syncs").select("*").order("created_at",{ascending:!1});if(r)throw r;return s||[]}async createScheduledSync(s){var i;const{data:r}=await S.auth.getUser(),{data:n,error:a}=await S.from("apify_scheduled_syncs").insert({...s,created_by:(i=r==null?void 0:r.user)==null?void 0:i.id}).select().single();if(a)throw a;return n}async updateScheduledSync(s,r){const{data:n,error:a}=await S.from("apify_scheduled_syncs").update(r).eq("id",s).select().single();if(a)throw a;return n}async deleteScheduledSync(s){const{error:r}=await S.from("apify_scheduled_syncs").delete().eq("id",s);if(r)throw r}async getSyncMetrics(){const{data:s,error:r}=await S.from("apify_sync_metrics").select("*");if(r)throw r;return s||[]}}const L=new je,Ge=Object.freeze(Object.defineProperty({__proto__:null,ApifyService:je,apifyService:L},Symbol.toStringTag,{value:"Module"})),Ze=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0),[a,i]=m.useState(!1),[u,p]=m.useState(null),[f,N]=m.useState(new Set),[P,T]=m.useState(!1);m.useEffect(()=>{E()},[]);const E=async()=>{try{n(!0);const c=await L.getConfigs();s(c)}catch(c){console.error("Error loading configs:",c)}finally{n(!1)}},k=async(c,d)=>{try{await L.toggleConfig(c,!d),await E()}catch(g){console.error("Error toggling config:",g),alert("Failed to toggle configuration")}},x=async c=>{if(confirm("Are you sure you want to delete this configuration?"))try{await L.deleteConfig(c),await E()}catch(d){console.error("Error deleting config:",d),alert("Failed to delete configuration")}},b=async c=>{N(d=>new Set(d).add(c));try{const d=await L.triggerManualSync(c);d.success?(alert("✅ Sync started successfully! Check the Sync Logs tab for progress."),await E()):alert(`❌ Failed to trigger sync: ${d.message}`)}catch(d){console.error("Error triggering sync:",d),alert("❌ Failed to trigger sync. Please check your configuration.")}finally{N(d=>{const g=new Set(d);return g.delete(c),g})}},o=async()=>{const c=t.filter(h=>h.is_active);if(c.length===0){alert("No active configurations to sync");return}if(!confirm(`Run sync for all ${c.length} active platform(s)?`))return;T(!0);let d=0,g=0;for(const h of c){N(y=>new Set(y).add(h.id));try{(await L.triggerManualSync(h.id)).success?d++:g++}catch(y){console.error(`Error syncing ${h.platform_name}:`,y),g++}finally{N(y=>{const D=new Set(y);return D.delete(h.id),D})}}T(!1),await E(),alert(`✅ Sync Complete!

Success: ${d}
Failed: ${g}

Check Sync Logs for details.`)},j=c=>{p(c),i(!0)},v=()=>{i(!1),p(null)},A=()=>{v(),E()};return r?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"How Job Sync Works"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Automatic:"})," Active platforms sync every ",e.jsx("strong",{children:"8 hours"})," automatically (configured in sync frequency)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Manual:"})," Click ",e.jsx("strong",{children:'"Run Now"'})," button to fetch jobs immediately without waiting"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bulk:"})," Use ",e.jsx("strong",{children:'"Sync All Active"'})," to run all active platforms at once"]})]})]})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Apify Configuration Manager"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage job platform connections and sync configurations"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:o,disabled:P||t.filter(c=>c.is_active).length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx($,{className:`w-4 h-4 ${P?"animate-spin":""}`}),P?"Syncing All...":"Sync All Active"]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Add Configuration"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Platforms"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:t.length})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Active"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:t.filter(c=>c.is_active).length})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Inactive"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.filter(c=>!c.is_active).length})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Syncing Now"}),e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:f.size})]})]}),a&&e.jsx(Xe,{config:u,onClose:v,onSuccess:A}),e.jsx("div",{className:"grid gap-4",children:t.length===0?e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-600",children:"No configurations found. Add your first platform connection!"})}):t.map(c=>{const d=f.has(c.id);return e.jsx("div",{className:`bg-white border rounded-lg p-6 hover:shadow-md transition-all ${d?"border-blue-400 shadow-lg":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c.platform_name}),d?e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full animate-pulse",children:[e.jsx($,{className:"w-3 h-3 animate-spin"}),"Syncing..."]}):c.is_active?e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:[e.jsx(H,{className:"w-3 h-3"}),"Active"]}):e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 bg-gray-100 text-gray-800 rounded-full",children:[e.jsx(G,{className:"w-3 h-3"}),"Inactive"]})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Actor ID:"})," ",c.actor_id]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Sync Frequency:"})," Every ",c.sync_frequency_hours," hours"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Last Sync:"})," ",c.last_sync_at?new Date(c.last_sync_at).toLocaleString():"Never"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Search Config:"})," ",L.formatSearchConfigForDisplay(c.search_config)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>b(c.id),disabled:!c.is_active||d,className:`px-3 py-2 rounded-lg transition-colors flex items-center gap-2 ${d?"bg-blue-100 text-blue-600 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50 disabled:cursor-not-allowed`,title:d?"Sync in progress...":"Run sync now",children:[e.jsx($,{className:`w-4 h-4 ${d?"animate-spin":""}`}),e.jsx("span",{className:"text-sm font-medium",children:d?"Syncing...":"Run Now"})]}),e.jsx("button",{onClick:()=>k(c.id,c.is_active),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:c.is_active?"Deactivate":"Activate",children:c.is_active?e.jsx(fe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(c),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Edit configuration",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(c.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete configuration",children:e.jsx(Q,{className:"w-4 h-4"})})]})]})},c.id)})})]})},Xe=({config:t,onClose:s,onSuccess:r})=>{const[n,a]=m.useState((t==null?void 0:t.platform_name)||""),[i,u]=m.useState((t==null?void 0:t.apify_api_token)||""),[p,f]=m.useState((t==null?void 0:t.actor_id)||""),[N,P]=m.useState((t==null?void 0:t.sync_frequency_hours)||8),[T,E]=m.useState(JSON.stringify((t==null?void 0:t.search_config)||{},null,2)),[k,x]=m.useState((t==null?void 0:t.is_active)??!0),[b,o]=m.useState(!1),[j,v]=m.useState(!1),A=L.getPopularActorIds(),c=h=>{if(a(h),A[h.toLowerCase()]){f(A[h.toLowerCase()]);const y=L.generateDefaultSearchConfig(h);E(JSON.stringify(y,null,2))}},d=async()=>{if(!i||!p){alert("Please enter API token and Actor ID");return}v(!0);try{const h=await L.testApifyConnection(i,p);h.success?alert("Connection successful!"):alert(`Connection failed: ${h.message}`)}catch{alert("Connection test failed")}finally{v(!1)}},g=async h=>{h.preventDefault();let y;try{y=JSON.parse(T)}catch{alert("Invalid JSON in search configuration");return}const D=L.validateSearchConfig(y);if(!D.valid){alert(`Invalid search config: ${D.errors.join(", ")}`);return}o(!0);try{t?await L.updateConfig(t.id,{platform_name:n,apify_api_token:i,actor_id:p,search_config:y,sync_frequency_hours:N,is_active:k}):await L.createConfig({platform_name:n,apify_api_token:i,actor_id:p,search_config:y,sync_frequency_hours:N,is_active:k}),r()}catch(w){console.error("Error saving config:",w),alert("Failed to save configuration")}finally{o(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Configuration":"Add Configuration"})}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform Name"}),e.jsxs("select",{value:n,onChange:h=>c(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Platform"}),e.jsx("option",{value:"LinkedIn",children:"LinkedIn"}),e.jsx("option",{value:"Indeed",children:"Indeed"}),e.jsx("option",{value:"Naukri",children:"Naukri"}),e.jsx("option",{value:"Instahyre",children:"Instahyre"}),e.jsx("option",{value:"Glassdoor",children:"Glassdoor"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apify API Token"}),e.jsx("input",{type:"password",value:i,onChange:h=>u(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your Apify API token",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Actor ID"}),e.jsx("input",{type:"text",value:p,onChange:h=>f(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., apify/linkedin-jobs-scraper",required:!0}),e.jsx("button",{type:"button",onClick:d,disabled:j,className:"mt-2 text-sm text-blue-600 hover:underline disabled:opacity-50",children:j?"Testing...":"Test Connection"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sync Frequency (hours)"}),e.jsx("input",{type:"number",value:N,onChange:h=>P(parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"168",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Configuration (JSON)"}),e.jsx("textarea",{value:T,onChange:h=>E(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",rows:10,placeholder:'{"keywords": ["software engineer"], "location": "India"}',required:!0}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("strong",{children:"Edit the JSON above to customize job search parameters."})," This JSON controls what jobs Apify will fetch."]}),e.jsxs("details",{className:"text-xs text-gray-600",children:[e.jsx("summary",{className:"cursor-pointer font-medium text-blue-600 hover:underline",children:"View Example Configurations"}),e.jsxs("div",{className:"mt-2 space-y-3 bg-gray-50 p-3 rounded border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"LinkedIn Example:"}),e.jsx("pre",{className:"bg-white p-2 rounded text-xs overflow-x-auto",children:`{
  "keywords": ["React Developer", "Node.js"],
  "location": "India",
  "datePosted": "week",
  "experienceLevel": ["Entry level", "Mid-Senior"],
  "jobType": ["Full-time"]
}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"Indeed Example:"}),e.jsx("pre",{className:"bg-white p-2 rounded text-xs overflow-x-auto",children:`{
  "position": "Software Engineer",
  "location": "Bangalore",
  "maxItems": 100,
  "datePosted": "7"
}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"Naukri Example:"}),e.jsx("pre",{className:"bg-white p-2 rounded text-xs overflow-x-auto",children:`{
  "keywords": "Python Developer",
  "location": "Mumbai",
  "experience": "0-3",
  "salary": "3-8"
}`})]})]})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:k,onChange:h=>x(h.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700",children:"Active (enable automatic syncing)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Saving...":t?"Update":"Create"})]})]})]})})},Ke=()=>{const[t,s]=m.useState([]),[r,n]=m.useState({totalSyncs:0,successfulSyncs:0,failedSyncs:0,totalJobsFetched:0,totalJobsCreated:0,lastSyncDate:null}),[a,i]=m.useState(!0),[u,p]=m.useState(null),[f,N]=m.useState("all");m.useEffect(()=>{P()},[]);const P=async()=>{try{i(!0);const[b,o]=await Promise.all([L.getSyncLogs(),L.getSyncStats()]);s(b),n(o)}catch(b){console.error("Error loading sync data:",b)}finally{i(!1)}},T=b=>{switch(b){case"success":return e.jsx(H,{className:"w-5 h-5 text-green-600"});case"failed":return e.jsx(G,{className:"w-5 h-5 text-red-600"});case"partial":return e.jsx(xe,{className:"w-5 h-5 text-yellow-600"});default:return e.jsx(V,{className:"w-5 h-5 text-blue-600"})}},E=b=>{switch(b){case"success":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"partial":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}},k=t.filter(b=>f==="all"?!0:b.status===f),x=(b,o)=>{if(!o)return"Running...";const j=new Date(o).getTime()-new Date(b).getTime(),v=Math.floor(j/1e3),A=Math.floor(v/60);return A>0?`${A}m ${v%60}s`:`${v}s`};return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Job Sync Dashboard"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor automated job syncs from Apify"})]}),e.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(z,{title:"Total Syncs",value:r.totalSyncs,icon:e.jsx(ee,{className:"w-5 h-5"}),color:"blue"}),e.jsx(z,{title:"Successful",value:r.successfulSyncs,icon:e.jsx(H,{className:"w-5 h-5"}),color:"green"}),e.jsx(z,{title:"Failed",value:r.failedSyncs,icon:e.jsx(G,{className:"w-5 h-5"}),color:"red"}),e.jsx(z,{title:"Jobs Fetched",value:r.totalJobsFetched,icon:e.jsx(W,{className:"w-5 h-5"}),color:"purple"}),e.jsx(z,{title:"Jobs Created",value:r.totalJobsCreated,icon:e.jsx(Fe,{className:"w-5 h-5"}),color:"indigo"}),e.jsx(z,{title:"Last Sync",value:r.lastSyncDate?new Date(r.lastSyncDate).toLocaleDateString():"Never",icon:e.jsx(ue,{className:"w-5 h-5"}),color:"gray",isText:!0})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter by status:"}),e.jsxs("select",{value:f,onChange:b=>N(b.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"partial",children:"Partial"}),e.jsx("option",{value:"running",children:"Running"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Platform"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Started"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fetched"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Updated"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No sync logs found"})}):k.map(b=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:b.platform_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${E(b.status)}`,children:[T(b.status),b.status]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(b.sync_started_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:x(b.sync_started_at,b.sync_completed_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:b.jobs_fetched}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:b.jobs_created}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600 font-medium",children:b.jobs_updated}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>p(b),className:"text-blue-600 hover:text-blue-900",children:"Details"})})]},b.id))})]})})]}),u&&e.jsx(Ye,{log:u,onClose:()=>p(null)})]})},z=({title:t,value:s,icon:r,color:n,isText:a=!1})=>{const i={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",red:"bg-red-100 text-red-600",purple:"bg-purple-100 text-purple-600",indigo:"bg-indigo-100 text-indigo-600",gray:"bg-gray-100 text-gray-600"};return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:t}),e.jsx("p",{className:`text-2xl font-bold mt-1 ${a?"text-sm":""}`,children:s})]}),e.jsx("div",{className:`p-3 rounded-lg ${i[n]}`,children:r})]})})},Ye=({log:t,onClose:s})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Sync Log Details"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:"✕"})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Platform"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t.platform_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${t.status==="success"?"bg-green-100 text-green-800":t.status==="failed"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:t.status})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Started At"}),e.jsx("p",{className:"mt-1 text-gray-900",children:new Date(t.sync_started_at).toLocaleString()})]}),t.sync_completed_at&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Completed At"}),e.jsx("p",{className:"mt-1 text-gray-900",children:new Date(t.sync_completed_at).toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jobs Fetched"}),e.jsx("p",{className:"mt-1 text-gray-900 font-semibold",children:t.jobs_fetched})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jobs Created"}),e.jsx("p",{className:"mt-1 text-green-600 font-semibold",children:t.jobs_created})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jobs Updated"}),e.jsx("p",{className:"mt-1 text-blue-600 font-semibold",children:t.jobs_updated})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Jobs Skipped"}),e.jsx("p",{className:"mt-1 text-gray-600 font-semibold",children:t.jobs_skipped})]})]}),t.error_message&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Error Message"}),e.jsx("p",{className:"mt-1 text-red-600 bg-red-50 p-3 rounded-lg text-sm",children:t.error_message})]}),t.sync_metadata&&Object.keys(t.sync_metadata).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Metadata"}),e.jsx("pre",{className:"mt-1 bg-gray-50 p-3 rounded-lg text-xs overflow-x-auto",children:JSON.stringify(t.sync_metadata,null,2)})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})}),et=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0),[a,i]=m.useState(!1),[u,p]=m.useState(null),[f,N]=m.useState("all"),[P,T]=m.useState({total:0,active:0,featured:0,byCategory:{}});m.useEffect(()=>{E(),k()},[]);const E=async()=>{try{n(!0);const d=await I.getAllUpdates();s(d)}catch(d){console.error("Error loading updates:",d),alert("Failed to load job updates")}finally{n(!1)}},k=async()=>{try{const d=await I.getStats();T(d)}catch(d){console.error("Error loading stats:",d)}},x=async d=>{if(confirm("Are you sure you want to delete this update?"))try{await I.deleteUpdate(d),await E(),await k()}catch(g){console.error("Error deleting update:",g),alert("Failed to delete update")}},b=async(d,g)=>{try{await I.toggleActive(d,!g),await E(),await k()}catch(h){console.error("Error toggling active status:",h),alert("Failed to update status")}},o=async(d,g)=>{try{await I.toggleFeatured(d,!g),await E(),await k()}catch(h){console.error("Error toggling featured status:",h),alert("Failed to update featured status")}},j=d=>{p(d),i(!0)},v=()=>{i(!1),p(null)},A=()=>{v(),E(),k()},c=t.filter(d=>f==="all"?!0:d.category===f);return r?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Job Updates Manager"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage job market updates, news, and announcements"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Add Update"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(K,{title:"Total Updates",value:P.total,color:"blue"}),e.jsx(K,{title:"Active",value:P.active,color:"green"}),e.jsx(K,{title:"Featured",value:P.featured,color:"yellow"}),e.jsx(K,{title:"Drafts",value:P.total-P.active,color:"gray"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter by category:"}),e.jsxs("select",{value:f,onChange:d=>N(d.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"market_trend",children:"Market Trend"}),e.jsx("option",{value:"hiring_news",children:"Hiring News"}),e.jsx("option",{value:"industry_update",children:"Industry Update"}),e.jsx("option",{value:"platform_update",children:"Platform Update"}),e.jsx("option",{value:"salary_insights",children:"Salary Insights"}),e.jsx("option",{value:"skill_demand",children:"Skill Demand"})]})]}),e.jsx("div",{className:"space-y-3",children:c.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No updates found"}):c.map(d=>{var g;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d.title}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${I.getCategoryColor(d.category)}`,children:I.getCategoryLabel(d.category)}),d.is_featured&&e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:[e.jsx(ie,{className:"w-3 h-3 fill-current"}),"Featured"]}),!d.is_active&&e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded-full",children:"Draft"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:d.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Published: ",new Date(d.published_at).toLocaleDateString()]}),d.source_platform&&e.jsxs("span",{children:["Source: ",d.source_platform]}),d.external_link&&e.jsxs("a",{href:d.external_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-blue-600 hover:underline",children:[e.jsx(Oe,{className:"w-3 h-3"}),"View Source"]})]}),((g=d.metadata)==null?void 0:g.tags)&&d.metadata.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.metadata.tags.map((h,y)=>e.jsxs("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded",children:["#",h]},y))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(d.id,d.is_featured),className:"p-2 text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:d.is_featured?"Remove from featured":"Add to featured",children:d.is_featured?e.jsx(Re,{className:"w-4 h-4"}):e.jsx(ie,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(d.id,d.is_active),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:d.is_active?"Set as draft":"Publish",children:d.is_active?e.jsx(Le,{className:"w-4 h-4"}):e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(d),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(d.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(Q,{className:"w-4 h-4"})})]})]})},d.id)})})]}),a&&e.jsx(tt,{update:u,onClose:v,onSuccess:A})]})},K=({title:t,value:s,color:r})=>{const n={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",yellow:"bg-yellow-100 text-yellow-600",gray:"bg-gray-100 text-gray-600"};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-2xl font-bold",children:s}),e.jsx("div",{className:`p-2 rounded-lg ${n[r]}`,children:e.jsx(W,{className:"w-4 h-4"})})]})]})},tt=({update:t,onClose:s,onSuccess:r})=>{const[n,a]=m.useState((t==null?void 0:t.title)||""),[i,u]=m.useState((t==null?void 0:t.description)||""),[p,f]=m.useState((t==null?void 0:t.content)||""),[N,P]=m.useState((t==null?void 0:t.category)||"industry_update"),[T,E]=m.useState((t==null?void 0:t.source_platform)||""),[k,x]=m.useState(JSON.stringify((t==null?void 0:t.metadata)||I.generateDefaultMetadata("industry_update"),null,2)),[b,o]=m.useState((t==null?void 0:t.image_url)||""),[j,v]=m.useState((t==null?void 0:t.external_link)||""),[A,c]=m.useState((t==null?void 0:t.is_featured)||!1),[d,g]=m.useState((t==null?void 0:t.is_active)??!0),[h,y]=m.useState(t!=null&&t.published_at?new Date(t.published_at).toISOString().slice(0,16):new Date().toISOString().slice(0,16)),[D,w]=m.useState(!1),F=_=>{if(P(_),!t){const R=I.generateDefaultMetadata(_);x(JSON.stringify(R,null,2))}},M=async _=>{_.preventDefault();let R;try{R=JSON.parse(k)}catch{alert("Invalid JSON in metadata field");return}const Z=I.validateMetadata(R);if(!Z.valid){alert(`Invalid metadata: ${Z.errors.join(", ")}`);return}w(!0);try{const O={title:n,description:i,content:p,category:N,source_platform:T||void 0,metadata:R,image_url:b||void 0,external_link:j||void 0,is_featured:A,is_active:d,published_at:new Date(h).toISOString()};t?await I.updateUpdate(t.id,O):await I.createUpdate(O),r()}catch(O){console.error("Error saving update:",O),alert("Failed to save update")}finally{w(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Update":"Create New Update"})}),e.jsxs("form",{onSubmit:M,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:n,onChange:_=>a(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter update title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Short Summary)"}),e.jsx("textarea",{value:i,onChange:_=>u(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,placeholder:"Brief description for preview",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Content"}),e.jsx("textarea",{value:p,onChange:_=>f(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:6,placeholder:"Detailed content of the update",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:N,onChange:_=>F(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"market_trend",children:"Market Trend"}),e.jsx("option",{value:"hiring_news",children:"Hiring News"}),e.jsx("option",{value:"industry_update",children:"Industry Update"}),e.jsx("option",{value:"platform_update",children:"Platform Update"}),e.jsx("option",{value:"salary_insights",children:"Salary Insights"}),e.jsx("option",{value:"skill_demand",children:"Skill Demand"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Platform (Optional)"}),e.jsx("input",{type:"text",value:T,onChange:_=>E(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., LinkedIn, Indeed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Metadata (JSON Format)"}),e.jsx("textarea",{value:k,onChange:_=>x(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",rows:8,placeholder:'{"tags": ["tag1", "tag2"], "stats": {"key": "value"}}',required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Flexible JSON data. Can include tags, stats, links, companies, locations, etc."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image URL (Optional)"}),e.jsx("input",{type:"url",value:b,onChange:_=>o(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"External Link (Optional)"}),e.jsx("input",{type:"url",value:j,onChange:_=>v(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://source.com/article"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Published Date/Time"}),e.jsx("input",{type:"datetime-local",value:h,onChange:_=>y(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:_=>c(_.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Featured (show prominently)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:_=>g(_.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active (publish now)"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:D,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:D?"Saving...":t?"Update":"Create"})]})]})]})})},st=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0),[a,i]=m.useState(null),[u,p]=m.useState(null),[f,N]=m.useState(""),[P,T]=m.useState(!1);m.useEffect(()=>{E()},[]);const E=async()=>{try{n(!0);const{data:o,error:j}=await S.from("job_sync_logs").select("*").eq("status","success").not("sync_metadata","is",null).order("sync_completed_at",{ascending:!1}).limit(50);if(j)throw j;s(o||[])}catch(o){console.error("Error loading logs:",o)}finally{n(!1)}},k=async o=>{T(!0),i(o);try{const{data:j,error:v}=await S.from("job_fetch_configs").select("apify_api_token").eq("id",o.config_id).single();if(v)throw v;const A=o.sync_metadata.dataset_id;if(!A)throw new Error("No dataset ID found in sync metadata");const c=await fetch(`https://api.apify.com/v2/datasets/${A}/items?format=json`,{headers:{Authorization:`Bearer ${j.apify_api_token}`}});if(!c.ok)throw new Error("Failed to fetch Apify data");const d=await c.json();p(d)}catch(j){console.error("Error fetching Apify JSON:",j),alert(`Failed to fetch JSON: ${j instanceof Error?j.message:"Unknown error"}`)}finally{T(!1)}},x=(o,j)=>{const v=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),A=URL.createObjectURL(v),c=document.createElement("a");c.href=A,c.download=j,c.click(),URL.revokeObjectURL(A)},b=t.filter(o=>o.platform_name.toLowerCase().includes(f.toLowerCase()));return r?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Apify JSON Data Viewer"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and download raw JSON responses from Apify runs"})]}),e.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:f,onChange:o=>N(o.target.value),placeholder:"Search by platform name...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ne,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1 text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"How to Access Apify JSON Data:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Select a successful sync from the list below"}),e.jsx("li",{children:'Click "View JSON" to fetch raw data from Apify'}),e.jsx("li",{children:'Use "Download JSON" to save the data locally'}),e.jsx("li",{children:"JSON shows the exact data structure returned by Apify before database mapping"})]})]})]})}),e.jsx("div",{className:"grid gap-4",children:b.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(ne,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:f?"No matching sync logs found":"No successful syncs with data available yet"})]}):b.map(o=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:o.platform_name}),e.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Success"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Fetched:"}),e.jsx("span",{className:"font-semibold text-gray-900 ml-2",children:o.jobs_fetched})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Created:"}),e.jsx("span",{className:"font-semibold text-green-600 ml-2",children:o.jobs_created})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Updated:"}),e.jsx("span",{className:"font-semibold text-blue-600 ml-2",children:o.jobs_updated})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Skipped:"}),e.jsx("span",{className:"font-semibold text-gray-600 ml-2",children:o.jobs_skipped})]})]}),e.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Completed:"})," ",new Date(o.sync_completed_at).toLocaleString()]}),o.sync_metadata.apify_run_id&&e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-medium",children:"Apify Run ID:"})," ",e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:o.sync_metadata.apify_run_id})]})]})]}),e.jsxs("button",{onClick:()=>k(o),disabled:P&&(a==null?void 0:a.id)===o.id,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ge,{className:"w-4 h-4"}),P&&(a==null?void 0:a.id)===o.id?"Loading...":"View JSON"]})]})},o.id))}),u&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Apify JSON Data - ",a.platform_name]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[u.length," jobs returned from Apify"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>x(u,`apify-${a.platform_name}-${Date.now()}.json`),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(ze,{className:"w-4 h-4"}),"Download JSON"]}),e.jsx("button",{onClick:()=>{p(null),i(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("pre",{className:"bg-gray-900 text-green-400 p-4 rounded-lg text-xs overflow-x-auto font-mono",children:JSON.stringify(u,null,2)})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[e.jsx(ne,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-gray-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Understanding the JSON Structure:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsxs("li",{children:["This is the ",e.jsx("strong",{children:"raw data"})," returned by Apify before any processing"]}),e.jsxs("li",{children:["Each object represents one job listing scraped from ",a.platform_name]}),e.jsxs("li",{children:["Fields like ",e.jsx("code",{children:"title"}),", ",e.jsx("code",{children:"company"}),", ",e.jsx("code",{children:"location"}),", ",e.jsx("code",{children:"description"})," are common"]}),e.jsx("li",{children:"The structure varies by platform and Apify actor"}),e.jsx("li",{children:"This data is mapped to your database schema by the Edge Function"})]})]})]})})]})})]})},le=[{label:"Every Hour",value:"0 * * * *",description:"Runs at the start of every hour"},{label:"Every 3 Hours",value:"0 */3 * * *",description:"Runs every 3 hours"},{label:"Every 6 Hours",value:"0 */6 * * *",description:"Runs every 6 hours"},{label:"Every 12 Hours",value:"0 */12 * * *",description:"Runs twice daily"},{label:"Daily at 9 AM",value:"0 9 * * *",description:"Runs every day at 9:00 AM"},{label:"Daily at 6 PM",value:"0 18 * * *",description:"Runs every day at 6:00 PM"},{label:"Weekdays at 9 AM",value:"0 9 * * 1-5",description:"Runs Mon-Fri at 9:00 AM"},{label:"Weekly on Monday",value:"0 9 * * 1",description:"Runs every Monday at 9:00 AM"},{label:"Monthly (1st day)",value:"0 9 1 * *",description:"Runs on the 1st of each month"}],rt=["UTC","America/New_York","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Kolkata","Asia/Tokyo","Australia/Sydney"],at=({configs:t})=>{var b;const[s,r]=m.useState([]),[n,a]=m.useState(!0),[i,u]=m.useState(!1),[p,f]=m.useState({config_id:"",schedule_name:"",cron_expression:"0 9 * * 1",timezone:"UTC",is_active:!0});m.useEffect(()=>{N()},[]);const N=async()=>{try{a(!0);const o=await L.getScheduledSyncs();r(o)}catch(o){console.error("Failed to load scheduled syncs:",o)}finally{a(!1)}},P=async()=>{if(!p.config_id||!p.schedule_name){alert("Please fill all required fields");return}try{await L.createScheduledSync(p),await N(),u(!1),f({config_id:"",schedule_name:"",cron_expression:"0 9 * * 1",timezone:"UTC",is_active:!0})}catch(o){console.error("Failed to create schedule:",o),alert("Failed to create schedule")}},T=async(o,j)=>{try{await L.updateScheduledSync(o,{is_active:!j}),await N()}catch(v){console.error("Failed to toggle schedule:",v)}},E=async o=>{if(confirm("Are you sure you want to delete this schedule?"))try{await L.deleteScheduledSync(o),await N()}catch(j){console.error("Failed to delete schedule:",j)}},k=o=>{var j;return((j=t.find(v=>v.id===o))==null?void 0:j.platform_name)||"Unknown"},x=o=>{if(!o)return"Not scheduled";const j=new Date(o),v=new Date,A=j.getTime()-v.getTime(),c=Math.floor(A/(1e3*60*60)),d=Math.floor(A%(1e3*60*60)/(1e3*60));return A<0?"Overdue":c<1?`In ${d} minutes`:c<24?`In ${c} hours`:j.toLocaleDateString()+" "+j.toLocaleTimeString()};return n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Scheduled Syncs"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Set up recurring sync schedules for your platforms"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(B,{size:20}),"Add Schedule"]})]}),s.length===0?e.jsxs("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-12 text-center",children:[e.jsx(ue,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Scheduled Syncs"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first schedule to automate syncs"}),e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Schedule"})]}):e.jsx("div",{className:"grid gap-4",children:s.map(o=>{var j;return e.jsx("div",{className:`border rounded-lg p-4 ${o.is_active?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:o.schedule_name}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${o.is_active?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"}`,children:o.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Platform:"})," ",k(o.config_id)]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Schedule:"})," ",((j=le.find(v=>v.value===o.cron_expression))==null?void 0:j.label)||o.cron_expression]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Timezone:"})," ",o.timezone]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Next Run:"})," ",x(o.next_run_at)]}),o.last_run_at&&e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Last Run:"})," ",new Date(o.last_run_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(o.id,o.is_active),className:`p-2 rounded-lg transition-colors ${o.is_active?"bg-gray-200 hover:bg-gray-300 text-gray-700":"bg-green-100 hover:bg-green-200 text-green-700"}`,title:o.is_active?"Deactivate":"Activate",children:o.is_active?e.jsx(fe,{size:18}):e.jsx(be,{size:18})}),e.jsx("button",{onClick:()=>E(o.id),className:"p-2 bg-red-100 hover:bg-red-200 text-red-600 rounded-lg transition-colors",title:"Delete",children:e.jsx(Q,{size:18})})]})]})},o.id)})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Create Scheduled Sync"}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Y,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Name *"}),e.jsx("input",{type:"text",value:p.schedule_name,onChange:o=>f({...p,schedule_name:o.target.value}),placeholder:"e.g., Weekly Monday LinkedIn Sync",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Platform *"}),e.jsxs("select",{value:p.config_id,onChange:o=>f({...p,config_id:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a platform"}),t.map(o=>e.jsx("option",{value:o.id,children:o.platform_name},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Pattern *"}),e.jsx("select",{value:p.cron_expression,onChange:o=>f({...p,cron_expression:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:le.map(o=>e.jsxs("option",{value:o.value,children:[o.label," - ",o.description]},o.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsx("select",{value:p.timezone,onChange:o=>f({...p,timezone:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:rt.map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:p.is_active,onChange:o=>f({...p,is_active:o.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Activate schedule immediately"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(V,{size:16}),"Schedule Preview"]}),e.jsx("p",{className:"text-sm text-blue-800",children:(b=le.find(o=>o.value===p.cron_expression))==null?void 0:b.description}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Cron: ",p.cron_expression," (",p.timezone,")"]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:P,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Schedule"})]})]})})})]})},nt=({configId:t})=>{const[s,r]=m.useState([]),[n,a]=m.useState([]),[i,u]=m.useState(!0),[p,f]=m.useState("30d");m.useEffect(()=>{N()},[t,p]);const N=async()=>{try{u(!0);const[c,d]=await Promise.all([L.getSyncLogs(),L.getSyncMetrics()]),g=p==="7d"?7:p==="30d"?30:90,h=new Date;h.setDate(h.getDate()-g);const y=c.filter(D=>{const F=new Date(D.created_at)>=h,M=!t||D.config_id===t;return F&&M});r(y),a(d)}catch(c){console.error("Failed to load sync data:",c)}finally{u(!1)}},P=()=>{const c=[...s].sort((M,_)=>new Date(M.created_at).getTime()-new Date(_.created_at).getTime()),d=Math.floor(c.length/2),g=c.slice(0,d),h=c.slice(d),y=g.reduce((M,_)=>M+_.jobs_fetched,0)/(g.length||1),D=h.reduce((M,_)=>M+_.jobs_fetched,0)/(h.length||1),w=g.filter(M=>M.status==="success").length/(g.length||1)*100,F=h.filter(M=>M.status==="success").length/(h.length||1)*100;return{jobsTrend:D-y,successTrend:F-w}},E=(()=>{const c={};return s.forEach(d=>{const g=new Date(d.created_at).toLocaleDateString();c[g]||(c[g]=[]),c[g].push(d)}),Object.entries(c).map(([d,g])=>({date:d,count:g.length,successCount:g.filter(h=>h.status==="success").length,failedCount:g.filter(h=>h.status==="failed").length,totalJobs:g.reduce((h,y)=>h+y.jobs_fetched,0),avgDuration:g.reduce((h,y)=>h+(y.duration_seconds||0),0)/g.length})).sort((d,g)=>new Date(d.date).getTime()-new Date(g.date).getTime())})(),k=Math.max(...E.map(c=>c.totalJobs),1),x=s.length>1?P():{jobsTrend:0,successTrend:0},b=s.length,o=s.filter(c=>c.status==="success").length;s.filter(c=>c.status==="failed").length;const j=b>0?o/b*100:0,v=s.reduce((c,d)=>c+d.jobs_fetched,0),A=s.reduce((c,d)=>c+(d.duration_seconds||0),0)/(b||1);return i?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Sync History & Trends"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Performance metrics and sync patterns over time"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f("7d"),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${p==="7d"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"7 Days"}),e.jsx("button",{onClick:()=>f("30d"),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${p==="30d"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"30 Days"}),e.jsx("button",{onClick:()=>f("90d"),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${p==="90d"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"90 Days"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Total Syncs"}),e.jsx(se,{className:"text-blue-600",size:20})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:b}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Last ",p==="7d"?"7":p==="30d"?"30":"90"," days"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Success Rate"}),e.jsx(H,{className:"text-green-600",size:20})]}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[j.toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs mt-1",children:[x.successTrend>0?e.jsx(W,{className:"text-green-600",size:14}):x.successTrend<0?e.jsx(me,{className:"text-red-600",size:14}):null,e.jsxs("span",{className:x.successTrend>=0?"text-green-600":"text-red-600",children:[Math.abs(x.successTrend).toFixed(1),"% trend"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Jobs Fetched"}),e.jsx(se,{className:"text-purple-600",size:20})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:v}),e.jsxs("div",{className:"flex items-center gap-1 text-xs mt-1",children:[x.jobsTrend>0?e.jsx(W,{className:"text-green-600",size:14}):x.jobsTrend<0?e.jsx(me,{className:"text-red-600",size:14}):null,e.jsxs("span",{className:x.jobsTrend>=0?"text-green-600":"text-red-600",children:[Math.abs(x.jobsTrend).toFixed(0)," avg trend"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Avg Duration"}),e.jsx(V,{className:"text-orange-600",size:20})]}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[A.toFixed(0),"s"]}),e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Per sync operation"})]})]}),E.length===0?e.jsxs("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-12 text-center",children:[e.jsx(se,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Sync History"}),e.jsx("p",{className:"text-gray-600",children:"Sync history will appear here once you run your first sync"})]}):e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Sync Activity Timeline"}),e.jsx("div",{className:"space-y-2",children:E.map((c,d)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 w-24",children:c.date}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 bg-gray-100 rounded-full h-8 overflow-hidden flex",children:[e.jsx("div",{className:"bg-green-500 flex items-center justify-center text-white text-xs font-medium",style:{width:`${c.successCount/c.count*100}%`},children:c.successCount>0&&c.successCount}),e.jsx("div",{className:"bg-red-500 flex items-center justify-center text-white text-xs font-medium",style:{width:`${c.failedCount/c.count*100}%`},children:c.failedCount>0&&c.failedCount})]}),e.jsxs("div",{className:"bg-blue-200 rounded-full h-8 flex items-center justify-center text-blue-900 text-xs font-medium px-3",style:{minWidth:`${Math.max(c.totalJobs/k*100,10)}px`},children:[c.totalJobs," jobs"]})]})]},d))}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsx("span",{children:"Success"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsx("span",{children:"Failed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-200 rounded"}),e.jsx("span",{children:"Jobs Fetched"})]})]})]}),n.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Platform Performance"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 font-medium text-gray-700",children:"Platform"}),e.jsx("th",{className:"text-right p-3 font-medium text-gray-700",children:"Total Syncs"}),e.jsx("th",{className:"text-right p-3 font-medium text-gray-700",children:"Success Rate"}),e.jsx("th",{className:"text-right p-3 font-medium text-gray-700",children:"Avg Jobs"}),e.jsx("th",{className:"text-right p-3 font-medium text-gray-700",children:"Avg Duration"}),e.jsx("th",{className:"text-right p-3 font-medium text-gray-700",children:"Last Sync"})]})}),e.jsx("tbody",{children:n.map(c=>{var g;const d=c.successful_syncs/c.total_syncs*100;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-medium text-gray-900",children:c.platform_name}),e.jsx("td",{className:"p-3 text-right text-gray-700",children:c.total_syncs}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("span",{className:`inline-flex items-center gap-1 ${d>=90?"text-green-700":d>=70?"text-yellow-700":"text-red-700"}`,children:[d.toFixed(0),"%"]})}),e.jsx("td",{className:"p-3 text-right text-gray-700",children:c.avg_jobs_fetched.toFixed(0)}),e.jsxs("td",{className:"p-3 text-right text-gray-700",children:[((g=c.avg_duration_seconds)==null?void 0:g.toFixed(0))||0,"s"]}),e.jsx("td",{className:"p-3 text-right text-gray-600 text-xs",children:new Date(c.last_sync_at).toLocaleDateString()})]},c.config_id)})})]})})]})]})},lt=()=>{const[t,s]=m.useState(null),[r,n]=m.useState("idle"),[a,i]=m.useState(null),[u,p]=m.useState([]),[f,N]=m.useState([]),[P,T]=m.useState(!0),[E,k]=m.useState(0),[x,b]=m.useState(null);m.useEffect(()=>{o(),j()},[]),m.useEffect(()=>()=>{x&&clearInterval(x)},[x]);const o=async()=>{try{const y=await L.getDefaultConfig();s(y)}catch(y){console.error("Error loading default config:",y)}finally{T(!1)}},j=async()=>{try{const{data:y,error:D}=await S.from("job_listings").select("id, company_name, role_title, location_city, package_amount, source_platform, created_at").order("created_at",{ascending:!1}).limit(10);!D&&y&&p(y)}catch(y){console.error("Error loading recent jobs:",y)}},v=y=>{const D=new Date().toLocaleTimeString();N(w=>[...w,`[${D}] ${y}`])},A=()=>{k(0);const y=setInterval(()=>{k(D=>D+1)},1e3);return b(y),y},c=y=>{clearInterval(y),b(null)},d=async()=>{var D;N([]),i(null),n("fetching");const y=A();v("Starting job fetch using default configuration...");try{const w=await L.triggerDefaultSync();if(w.config&&(v(`Configuration: ${w.config.platform_name}`),v(`Actor ID: ${w.config.actor_id}`)),w.success){if(v("Apify run started successfully!"),v("Waiting for Apify to fetch jobs from job boards..."),await new Promise(F=>setTimeout(F,2e3)),v("Processing fetched jobs..."),w.config){const{data:F}=await S.from("job_sync_logs").select("*").eq("config_id",w.config.id).order("sync_started_at",{ascending:!1}).limit(1).maybeSingle();if(F){const M={fetched:F.jobs_fetched||0,created:F.jobs_created||0,updated:F.jobs_updated||0,skipped:F.jobs_skipped||0};v(`Jobs fetched from Apify: ${M.fetched}`),v(`New jobs created: ${M.created}`),v(`Existing jobs updated: ${M.updated}`),v(`Jobs skipped: ${M.skipped}`),i({platform:w.config.platform_name,success:!0,stats:M})}else i({platform:w.config.platform_name,success:!0,stats:w.stats})}v("Sync completed successfully!"),n("success"),await j()}else v(`Error: ${w.message||"Unknown error"}`),i({platform:((D=w.config)==null?void 0:D.platform_name)||"Unknown",success:!1,error:w.message}),n("error")}catch(w){const F=w instanceof Error?w.message:"Unknown error";v(`Error: ${F}`),i({platform:"Unknown",success:!1,error:F}),n("error")}finally{c(y)}},g=y=>{const D=Math.floor(y/60),w=y%60;return D>0?`${D}m ${w}s`:`${w}s`},h=()=>{switch(r){case"fetching":return"bg-blue-500";case"success":return"bg-green-500";case"error":return"bg-red-500";default:return"bg-gray-400"}};return P?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-lg",children:e.jsx(Qe,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Fetch Jobs"}),e.jsx("p",{className:"text-blue-100",children:"One-click job sync automation"})]})]}),t&&e.jsxs("div",{className:"bg-white/10 rounded-lg px-4 py-2 flex items-center gap-2",children:[e.jsx(Be,{size:16,className:"text-blue-200"}),e.jsxs("span",{className:"text-sm text-blue-100",children:["Using: ",e.jsx("span",{className:"font-semibold text-white",children:t.platform_name})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:d,disabled:r==="fetching"||!t,className:`flex-1 py-5 px-8 rounded-xl font-bold text-xl flex items-center justify-center gap-4 transition-all shadow-lg ${r==="fetching"?"bg-gray-400 cursor-not-allowed":t?"bg-green-500 hover:bg-green-600 hover:scale-[1.02] active:scale-[0.98] hover:shadow-xl":"bg-gray-400 cursor-not-allowed"}`,children:r==="fetching"?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"animate-spin",size:28}),"Fetching Jobs..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{size:28}),"Fetch Jobs Now"]})}),e.jsxs("div",{className:"bg-white/10 rounded-xl p-4 min-w-[140px] text-center",children:[e.jsx("div",{className:`w-5 h-5 rounded-full ${h()} mx-auto mb-2 ${r==="fetching"?"animate-pulse":""}`}),e.jsxs("p",{className:"text-sm font-medium",children:[r==="idle"&&"Ready",r==="fetching"&&"Fetching...",r==="success"&&"Completed",r==="error"&&"Failed"]}),r==="fetching"&&e.jsx("p",{className:"text-xs text-blue-200 mt-1",children:g(E)})]})]}),!t&&e.jsxs("div",{className:"mt-4 bg-yellow-500/20 border border-yellow-400/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(re,{className:"text-yellow-300 flex-shrink-0 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-100",children:"No configuration found"}),e.jsx("p",{className:"text-sm text-yellow-200 mt-1",children:'Please add an Apify configuration in the "Configuration Manager" tab first.'})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(V,{size:18,className:"text-gray-500"}),"Live Logs"]}),f.length>0&&e.jsx("button",{onClick:()=>N([]),className:"text-xs text-gray-500 hover:text-gray-700",children:"Clear"})]}),e.jsx("div",{className:"p-4 h-64 overflow-y-auto bg-gray-900 rounded-b-xl",children:f.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"Logs will appear here when you start fetching..."}):e.jsx("div",{className:"space-y-1 font-mono text-xs",children:f.map((y,D)=>e.jsx("div",{className:`${y.includes("Error")?"text-red-400":y.includes("successfully")||y.includes("completed")?"text-green-400":"text-gray-300"}`,children:y},D))})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{size:18,className:"text-gray-500"}),"Sync Results"]})}),e.jsx("div",{className:"p-6",children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.success?e.jsx(H,{className:"text-green-500",size:24}):e.jsx(G,{className:"text-red-500",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:a.platform}),e.jsx("p",{className:`text-sm ${a.success?"text-green-600":"text-red-600"}`,children:a.success?"Sync completed successfully":"Sync failed"})]})]}),a.stats&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Fetched"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.stats.fetched})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Created"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.stats.created})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-yellow-600 font-medium",children:"Updated"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:a.stats.updated})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Skipped"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.stats.skipped})]})]}),a.error&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(re,{className:"text-red-500 flex-shrink-0 mt-0.5",size:18}),e.jsx("p",{className:"text-sm text-red-700",children:a.error})]})})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ee,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Run a sync to see results here"})]})})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ce,{size:18,className:"text-gray-500"}),"Recently Synced Jobs (Last 10)"]}),e.jsxs("button",{onClick:j,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx($,{size:14}),"Refresh"]})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:u.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(ce,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No jobs found. Run a sync to fetch jobs."})]}):u.map(y=>e.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:y.role_title}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{size:14}),y.company_name]}),y.location_city&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),y.location_city]}),y.package_amount&&e.jsxs("span",{className:"text-green-600 font-medium",children:[y.package_amount," LPA"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:y.source_platform}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(y.created_at).toLocaleDateString()})]})]})},y.id))})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(re,{size:18}),"How This Works"]}),e.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:'Click "Fetch Jobs Now" to trigger the Apify sync'}),e.jsx("li",{children:"Apify scrapes jobs using your saved JSON configuration"}),e.jsx("li",{children:"Jobs are processed and saved to the database"}),e.jsx("li",{children:'New jobs appear in the "Recently Synced Jobs" section'}),e.jsx("li",{children:'Check "Sync Logs" tab for detailed sync history'})]})]})]})};class ot{async getActiveJobsCount(){const{count:s,error:r}=await S.from("job_listings").select("*",{count:"exact",head:!0}).eq("is_active",!0);return r?(console.error("Error fetching active jobs count:",r),0):s||0}async getSyncLogs(s=10){const{data:r,error:n}=await S.from("job_sync_logs").select("*").order("sync_started_at",{ascending:!1}).limit(s);return n?(console.error("Error fetching sync logs:",n),[]):r||[]}async getLastSync(){const{data:s,error:r}=await S.from("job_sync_logs").select("*").order("sync_started_at",{ascending:!1}).limit(1).maybeSingle();return r?(console.error("Error fetching last sync:",r),null):s}async getSyncStats(){const[s,r,n]=await Promise.all([this.getActiveJobsCount(),this.getSyncLogs(10),this.getLast24hStats()]);return{totalActiveJobs:s,lastSync:r[0]||null,recentSyncs:r,totalJobsCreatedLast24h:n.created,totalJobsUpdatedLast24h:n.updated}}async getLast24hStats(){const s=new Date;s.setDate(s.getDate()-1);const{data:r,error:n}=await S.from("job_sync_logs").select("jobs_created, jobs_updated").gte("sync_started_at",s.toISOString()).eq("status","success");return n?(console.error("Error fetching 24h stats:",n),{created:0,updated:0}):(r||[]).reduce((i,u)=>({created:i.created+(u.jobs_created||0),updated:i.updated+(u.jobs_updated||0)}),{created:0,updated:0})}async triggerSync(){try{const s=await S.functions.invoke("apify-sync-jobs",{body:{}});if(s.error)throw new Error(s.error.message);return{success:!0,stats:s.data}}catch(s){return console.error("Error triggering sync:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async isCurrentlyRunning(){const{data:s,error:r}=await S.from("job_sync_logs").select("id").eq("status","running").limit(1);return r?(console.error("Error checking running status:",r),!1):((s==null?void 0:s.length)||0)>0}}const oe=new ot,it=()=>{const[t,s]=m.useState(null),[r,n]=m.useState(!0),[a,i]=m.useState(!1),[u,p]=m.useState(null),f=m.useCallback(async()=>{try{n(!0),p(null);const x=await oe.getSyncStats();s(x);const b=await oe.isCurrentlyRunning();i(b)}catch(x){p("Failed to load sync stats"),console.error(x)}finally{n(!1)}},[]);m.useEffect(()=>{f();const x=setInterval(f,3e4);return()=>clearInterval(x)},[f]);const N=async()=>{if(!a){i(!0),p(null);try{const x=await oe.triggerSync();x.success||p(x.error||"Sync failed"),await f()}catch(x){p("Failed to trigger sync"),console.error(x)}finally{i(!1)}}},P=x=>new Date(x).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),T=x=>{if(!x)return"-";if(x<60)return`${x}s`;const b=Math.floor(x/60),o=x%60;return`${b}m ${o}s`},E=x=>{switch(x){case"success":return e.jsx(H,{className:"h-5 w-5 text-green-500"});case"failed":return e.jsx(G,{className:"h-5 w-5 text-red-500"});case"running":return e.jsx($,{className:"h-5 w-5 text-blue-500 animate-spin"});default:return e.jsx(V,{className:"h-5 w-5 text-yellow-500"})}},k=x=>({success:"bg-green-100 text-green-800 border-green-200",failed:"bg-red-100 text-red-800 border-red-200",running:"bg-blue-100 text-blue-800 border-blue-200",partial:"bg-yellow-100 text-yellow-800 border-yellow-200"})[x]||"bg-gray-100 text-gray-800 border-gray-200";return r&&!t?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Job Sync Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Monitor and trigger job synchronization from LinkedIn"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:f,disabled:r,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",title:"Refresh stats",children:e.jsx($,{className:`h-5 w-5 ${r?"animate-spin":""}`})}),e.jsx("button",{onClick:N,disabled:a,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Syncing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{children:"Run Now"})]})})]})]}),u&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3",children:[e.jsx(xe,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700",children:u})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Active Jobs"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:(t==null?void 0:t.totalActiveJobs.toLocaleString())||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(ee,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created (24h)"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600 mt-1",children:["+",(t==null?void 0:t.totalJobsCreatedLast24h)||0]})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(W,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Updated (24h)"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600 mt-1",children:(t==null?void 0:t.totalJobsUpdatedLast24h)||0})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx($,{className:"h-6 w-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Last Sync Status"}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:t!=null&&t.lastSync?e.jsxs(e.Fragment,{children:[E(t.lastSync.status),e.jsx("span",{className:"text-lg font-semibold capitalize",children:t.lastSync.status})]}):e.jsx("span",{className:"text-gray-400",children:"No syncs yet"})})]}),e.jsx("div",{className:"p-3 bg-gray-100 rounded-full",children:e.jsx(V,{className:"h-6 w-6 text-gray-600"})})]})})]}),(t==null?void 0:t.lastSync)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Last Sync Details"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Platform"}),e.jsx("p",{className:"font-medium",children:t.lastSync.platform_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Started"}),e.jsx("p",{className:"font-medium",children:P(t.lastSync.sync_started_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Duration"}),e.jsx("p",{className:"font-medium",children:T(t.lastSync.duration_seconds)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Jobs Fetched"}),e.jsx("p",{className:"font-medium",children:t.lastSync.jobs_fetched??"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Jobs Created"}),e.jsxs("p",{className:"font-medium text-green-600",children:["+",t.lastSync.jobs_created??0]})]})]}),t.lastSync.error_message&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:t.lastSync.error_message})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sync History"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Platform"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Started"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fetched"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Skipped"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[t==null?void 0:t.recentSyncs.map(x=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${k(x.status)}`,children:x.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:x.platform_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:P(x.sync_started_at)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:T(x.duration_seconds)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:x.jobs_fetched??"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm text-green-600",children:["+",x.jobs_created??0]}),e.jsx("td",{className:"px-4 py-3 text-sm text-orange-600",children:x.jobs_updated??0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:x.jobs_skipped??0})]},x.id)),(!(t!=null&&t.recentSyncs)||t.recentSyncs.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:'No sync history available. Click "Run Now" to start a sync.'})})]})]})})]})]})},Lt=()=>{const[t,s]=m.useState("questions"),[r,n]=m.useState([]),[a,i]=m.useState([]),[u,p]=m.useState({basePrice:49,currency:"INR",activeCoupons:[]}),[f,N]=m.useState(!1),[P,T]=m.useState(!0),[E,k]=m.useState(!1),[x,b]=m.useState(null),[o,j]=m.useState({company:"",role:"",category:"coding",difficulty:"medium",questionText:"",solutionText:"",codeLanguage:"javascript",codeExample:"",explanation:"",tags:"",imageUrl:"",price:49}),[v,A]=m.useState(!1),[c,d]=m.useState(null),[g,h]=m.useState({title:"",description:"",category:"interview-tips",company:"",role:"",content:"",imageUrl:""}),[y,D]=m.useState(!1),[w,F]=m.useState({code:"",discount:0,description:""});m.useEffect(()=>{M()},[]);const M=async()=>{try{const[l,C,U]=await Promise.all([J.getQuestions(),J.getMaterials(),J.getPaymentSettings()]);n(l),i(C),p(U)}catch(l){console.error("Error loading data:",l),n([]),i([]),p({basePrice:49,currency:"INR",activeCoupons:[]})}finally{T(!1)}},_=()=>{j({company:"",role:"",category:"coding",difficulty:"medium",questionText:"",solutionText:"",codeLanguage:"javascript",codeExample:"",explanation:"",tags:"",imageUrl:"",price:49}),b(null)},R=async()=>{N(!0);try{console.log("Adding question with form data:",o);const l=await J.saveQuestion({...o,tags:o.tags.split(",").map(C=>C.trim()).filter(C=>C)});if(l)console.log("Question added successfully:",l),n([l,...r]),_(),k(!1),alert("✅ Question added successfully!");else throw new Error("Failed to save question - no data returned")}catch(l){console.error("Error adding question:",l),alert(`❌ Failed to add question. Please check your connection and try again.

Error: `+(l.message||"Unknown error"))}finally{N(!1)}},Z=l=>{j({company:l.company,role:l.role,category:l.category,difficulty:l.difficulty,questionText:l.questionText,solutionText:l.solutionText,codeLanguage:"javascript",codeExample:l.codeExample||"",explanation:l.explanation,tags:l.tags.join(", "),imageUrl:l.imageUrl||"",price:l.price||(l.category==="coding"?49:0)}),b(l),k(!0)},O=async()=>{if(x){N(!0);try{console.log("Updating question:",x.id,"with data:",o);const l=await J.updateQuestion(x.id,{...o,tags:o.tags.split(",").map(C=>C.trim()).filter(C=>C)});if(l)console.log("Question updated successfully:",l),n(r.map(C=>C.id===x.id?l:C)),_(),k(!1),alert("✅ Question updated successfully!");else throw new Error("Failed to update question - no data returned")}catch(l){console.error("Error updating question:",l),alert(`❌ Failed to update question. Please check your connection and try again.

Error: `+(l.message||"Unknown error"))}finally{N(!1)}}},Ne=async l=>{if(confirm("Are you sure you want to delete this question?")){N(!0);try{if(console.log("Deleting question:",l),await J.deleteQuestion(l))console.log("Question deleted successfully"),n(r.filter(U=>U.id!==l)),alert("✅ Question deleted successfully!");else throw new Error("Failed to delete question")}catch(C){console.error("Error deleting question:",C),alert(`❌ Failed to delete question. Please check your connection and try again.

Error: `+(C.message||"Unknown error"))}finally{N(!1)}}},X=()=>{h({title:"",description:"",category:"interview-tips",company:"",role:"",content:"",imageUrl:""}),d(null)},ve=async()=>{N(!0);try{console.log("Adding material with form data:",g);const l=await J.saveMaterial(g);if(l)console.log("Material added successfully:",l),i([l,...a]),X(),A(!1),alert("✅ Material added successfully!");else throw new Error("Failed to save material - no data returned")}catch(l){console.error("Error adding material:",l),alert(`❌ Failed to add material. Please check your connection and try again.

Error: `+(l.message||"Unknown error"))}finally{N(!1)}},we=l=>{h({title:l.title,description:l.description,category:l.category,company:l.company||"",role:l.role||"",content:l.content,imageUrl:l.imageUrl}),d(l),A(!0)},Se=async()=>{if(c){N(!0);try{console.log("Updating material:",c.id,"with data:",g);const l=await J.updateMaterial(c.id,g);if(l)console.log("Material updated successfully:",l),i(a.map(C=>C.id===c.id?l:C)),X(),A(!1),alert("✅ Material updated successfully!");else throw new Error("Failed to update material - no data returned")}catch(l){console.error("Error updating material:",l),alert(`❌ Failed to update material. Please check your connection and try again.

Error: `+(l.message||"Unknown error"))}finally{N(!1)}}},_e=async l=>{if(confirm("Are you sure you want to delete this material?")){N(!0);try{if(console.log("Deleting material:",l),await J.deleteMaterial(l))console.log("Material deleted successfully"),i(a.filter(U=>U.id!==l)),alert("✅ Material deleted successfully!");else throw new Error("Failed to delete material")}catch(C){console.error("Error deleting material:",C),alert(`❌ Failed to delete material. Please check your connection and try again.

Error: `+(C.message||"Unknown error"))}finally{N(!1)}}},Ce=async()=>{if(!w.code.trim()||w.discount<=0){alert("❌ Please enter a valid coupon code and discount percentage.");return}if(u.activeCoupons.find(q=>q.code.toLowerCase()===w.code.toLowerCase())){alert("❌ A coupon with this code already exists. Please use a different code.");return}const C={...w},U={...u,activeCoupons:[...u.activeCoupons,C]};N(!0);try{if(console.log("Adding coupon:",C),await J.savePaymentSettings(U))console.log("Coupon added successfully"),p(U),F({code:"",discount:0,description:""}),D(!1),alert("✅ Coupon added successfully!");else throw new Error("Failed to save payment settings")}catch(q){console.error("Error adding coupon:",q),alert(`❌ Failed to add coupon. Please check your connection and try again.

Error: `+(q.message||"Unknown error"))}finally{N(!1)}},ke=async l=>{const C={...u,activeCoupons:u.activeCoupons.filter((U,q)=>q!==l)};N(!0);try{if(console.log("Deleting coupon at index:",l),await J.savePaymentSettings(C))console.log("Coupon deleted successfully"),p(C),alert("✅ Coupon deleted successfully!");else throw new Error("Failed to save payment settings")}catch(U){console.error("Error deleting coupon:",U),alert(`❌ Failed to delete coupon. Please check your connection and try again.

Error: `+(U.message||"Unknown error"))}finally{N(!1)}},Ee=async l=>{const C={...u,basePrice:l};N(!0);try{if(console.log("Updating base price to:",l),await J.savePaymentSettings(C))console.log("Base price updated successfully"),p(C),alert("✅ Base price updated successfully!");else throw new Error("Failed to save payment settings")}catch(U){console.error("Error updating base price:",U),alert(`❌ Failed to update base price. Please check your connection and try again.

Error: `+(U.message||"Unknown error"))}finally{N(!1)}},Ae=l=>{switch(l){case"coding":return e.jsx(We,{className:"h-4 w-4"});case"aptitude":return e.jsx($e,{className:"h-4 w-4"});case"interview":return e.jsx(Ie,{className:"h-4 w-4"});case"technical":return e.jsx(ie,{className:"h-4 w-4"});default:return e.jsx(Je,{className:"h-4 w-4"})}},De=l=>{switch(l){case"coding":return"bg-blue-100 text-blue-800 border-blue-200";case"aptitude":return"bg-purple-100 text-purple-800 border-purple-200";case"interview":return"bg-green-100 text-green-800 border-green-200";case"technical":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Pe=l=>{switch(l){case"easy":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"hard":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return P?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Loading admin panel..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Manage questions, materials, and payment settings"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>s("questions"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="questions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Questions (",r.length,")"]}),e.jsxs("button",{onClick:()=>s("materials"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="materials"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Materials (",a.length,")"]}),e.jsx("button",{onClick:()=>s("payments"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Payment Settings"}),e.jsx("button",{onClick:()=>s("fetch-jobs"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="fetch-jobs"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Fetch Jobs"}),e.jsx("button",{onClick:()=>s("job-sync"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="job-sync"?"border-teal-500 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Job Sync"}),e.jsx("button",{onClick:()=>s("apify-config"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="apify-config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Apify Config"}),e.jsx("button",{onClick:()=>s("sync-logs"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="sync-logs"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Sync Logs"}),e.jsx("button",{onClick:()=>s("apify-json"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="apify-json"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Apify JSON"}),e.jsx("button",{onClick:()=>s("job-updates"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="job-updates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Job Updates"}),e.jsx("button",{onClick:()=>s("scheduled-syncs"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="scheduled-syncs"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Scheduled Syncs"}),e.jsx("button",{onClick:()=>s("sync-history"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${t==="sync-history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Sync History"})]})})}),t==="questions"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Manage Questions"}),e.jsxs("button",{onClick:()=>k(!0),disabled:f,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Question"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.map(l=>e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("span",{className:"flex items-center space-x-1 text-gray-600",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:l.company})]}),e.jsxs("span",{className:"flex items-center space-x-1 text-gray-600",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:l.role})]}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${De(l.category)}`,children:[Ae(l.category),e.jsx("span",{className:"ml-1",children:l.category})]}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${Pe(l.difficulty)}`,children:l.difficulty}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200",children:[e.jsx(He,{className:"h-3 w-3 mr-1"}),"₹",l.price||0]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l.questionText}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:l.solutionText}),l.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:l.tags.map((C,U)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["#",C]},U))})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>Z(l),disabled:f,className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Ne(l.id),disabled:f,className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})},l.id))})]}),t==="materials"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Manage Materials"}),e.jsxs("button",{onClick:()=>A(!0),disabled:f,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Material"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(l=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("img",{src:l.imageUrl,alt:l.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:l.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:new Date(l.uploadedAt).toLocaleDateString()}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>we(l),disabled:f,className:"p-1 text-blue-600 hover:bg-blue-100 rounded transition-colors disabled:opacity-50",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_e(l.id),disabled:f,className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors disabled:opacity-50",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})]})]},l.id))})]}),t==="payments"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Payment Settings"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Base Price Settings"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Default Base Price:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-500",children:"₹"}),e.jsx("input",{type:"number",value:u.basePrice,onChange:l=>Ee(Number(l.target.value)),disabled:f,className:"w-24 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This is the default price for new coding questions. Individual questions can have custom prices."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Active Coupon Codes"}),e.jsxs("button",{onClick:()=>D(!0),disabled:f,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Coupon"})]})]}),e.jsx("div",{className:"space-y-3",children:u.activeCoupons.map((l,C)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ve,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-mono font-medium",children:l.code}),e.jsxs("span",{className:"text-green-600 font-medium",children:[l.discount,"% OFF"]}),l.description&&e.jsxs("span",{className:"text-gray-500 text-sm",children:["- ",l.description]})]}),e.jsx("button",{onClick:()=>ke(C),disabled:f,className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors disabled:opacity-50",children:e.jsx(Q,{className:"h-4 w-4"})})]},C))})]})]}),t==="fetch-jobs"&&e.jsx(lt,{}),t==="job-sync"&&e.jsx(it,{}),t==="apify-config"&&e.jsx(Ze,{}),t==="sync-logs"&&e.jsx(Ke,{}),t==="apify-json"&&e.jsx(st,{}),t==="job-updates"&&e.jsx(et,{}),t==="scheduled-syncs"&&e.jsx(ct,{}),t==="sync-history"&&e.jsx(nt,{}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:x?"Edit Question":"Add New Question"}),e.jsx("button",{onClick:()=>{k(!1),_()},className:"text-gray-400 hover:text-gray-600",children:e.jsx(Y,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsx("input",{type:"text",value:o.company,onChange:l=>j({...o,company:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., TCS, Wipro, Infosys",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsx("input",{type:"text",value:o.role,onChange:l=>j({...o,role:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Software Engineer, Analyst",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:o.category,onChange:l=>j({...o,category:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"coding",children:"Coding"}),e.jsx("option",{value:"aptitude",children:"Aptitude"}),e.jsx("option",{value:"interview",children:"Interview"}),e.jsx("option",{value:"technical",children:"Technical"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty"}),e.jsxs("select",{value:o.difficulty,onChange:l=>j({...o,difficulty:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (₹)"}),e.jsx("input",{type:"number",value:o.price,onChange:l=>j({...o,price:Number(l.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0 for free, 49 for premium",min:"0",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text"}),e.jsx("textarea",{value:o.questionText,onChange:l=>j({...o,questionText:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Enter the question text...",required:!0})]}),o.category==="coding"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programming Language"}),e.jsxs("select",{value:o.codeLanguage,onChange:l=>j({...o,codeLanguage:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"javascript",children:"JavaScript"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"java",children:"Java"}),e.jsx("option",{value:"cpp",children:"C++"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Solution Text"}),e.jsx("textarea",{value:o.solutionText,onChange:l=>j({...o,solutionText:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Enter the solution approach...",required:!0})]}),o.category==="coding"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Code Example (",o.codeLanguage==="cpp"?"C++":o.codeLanguage.charAt(0).toUpperCase()+o.codeLanguage.slice(1),")"]}),e.jsx("textarea",{value:o.codeExample,onChange:l=>j({...o,codeExample:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",rows:6,placeholder:`Enter ${o.codeLanguage==="cpp"?"C++":o.codeLanguage} code example...`}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Write your code solution in ",o.codeLanguage==="cpp"?"C++":o.codeLanguage]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detailed Explanation"}),e.jsx("textarea",{value:o.explanation,onChange:l=>j({...o,explanation:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4,placeholder:"Enter detailed explanation...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:o.tags,onChange:l=>j({...o,tags:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., array, sorting, algorithm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL (Optional)"}),e.jsx("input",{type:"url",value:o.imageUrl,onChange:l=>j({...o,imageUrl:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{k(!1),_()},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x?O:R,disabled:f||!o.company.trim()||!o.role.trim()||!o.questionText.trim()||!o.solutionText.trim()||!o.explanation.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[f&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:f?x?"Updating...":"Adding...":x?"Update Question":"Add Question"})]})]})]})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:c?"Edit Material":"Add New Material"}),e.jsx("button",{onClick:()=>{A(!1),X()},className:"text-gray-400 hover:text-gray-600",children:e.jsx(Y,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),e.jsx("input",{type:"text",value:g.title,onChange:l=>h({...g,title:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter material title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:l=>h({...g,description:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Enter material description",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:g.category,onChange:l=>h({...g,category:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"interview-tips",children:"Interview Tips"}),e.jsx("option",{value:"coding-guide",children:"Coding Guide"}),e.jsx("option",{value:"aptitude-tricks",children:"Aptitude Tricks"}),e.jsx("option",{value:"company-specific",children:"Company Specific"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company (Optional)"}),e.jsx("input",{type:"text",value:g.company,onChange:l=>h({...g,company:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., TCS, Wipro"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role (Optional)"}),e.jsx("input",{type:"text",value:g.role,onChange:l=>h({...g,role:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Software Engineer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content"}),e.jsx("textarea",{value:g.content,onChange:l=>h({...g,content:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:6,placeholder:"Enter the material content...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),e.jsx("input",{type:"url",value:g.imageUrl,onChange:l=>h({...g,imageUrl:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/image.jpg",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{A(!1),X()},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:c?Se:ve,disabled:f||!g.title.trim()||!g.description.trim()||!g.content.trim()||!g.imageUrl.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[f&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:f?c?"Updating...":"Adding...":c?"Update Material":"Add Material"})]})]})]})})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Add New Coupon"}),e.jsx("button",{onClick:()=>{D(!1),F({code:"",discount:0,description:""})},className:"text-gray-400 hover:text-gray-600",children:e.jsx(Y,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Coupon Code"}),e.jsx("input",{type:"text",value:w.code,onChange:l=>F({...w,code:l.target.value.toUpperCase()}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono",placeholder:"e.g., SAVE20",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Percentage"}),e.jsx("input",{type:"number",value:w.discount,onChange:l=>F({...w,discount:Number(l.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 20",min:"0",max:"100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("input",{type:"text",value:w.description,onChange:l=>F({...w,description:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 20% discount"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{D(!1),F({code:"",discount:0,description:""})},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:Ce,disabled:f||!w.code.trim()||w.discount<=0||w.discount>100,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[f&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:f?"Adding...":"Add Coupon"})]})]})]})})]})})},ct=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0);m.useEffect(()=>{a()},[]);const a=async()=>{try{n(!0);const{apifyService:i}=await Te(async()=>{const{apifyService:p}=await Promise.resolve().then(()=>Ge);return{apifyService:p}},void 0),u=await i.getConfigs();s(u)}catch(i){console.error("Error loading configs:",i)}finally{n(!1)}};return r?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx(at,{configs:t})};export{Lt as default};
