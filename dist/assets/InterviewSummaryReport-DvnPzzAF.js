var C=Object.defineProperty;var q=(g,t,r)=>t in g?C(g,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):g[t]=r;var f=(g,t,r)=>q(g,typeof t!="symbol"?t+"":t,r);import{c as T,s as k,g as A,X as F,T as M,t as I,K as P}from"./index-BbSeE-q4.js";import{r as w}from"./vendor-react-B4msnGgW.js";import{j as s}from"./vendor-motion-_XdJ9pBm.js";import{P as $}from"./play-BW95sg1B.js";import{P as D}from"./pause-C7_k2ztz.js";import{g as R}from"./geminiServiceWrapper-tvm4MzT7.js";import{e as L}from"./edenAITextService-y6w1oEiu.js";import{T as O}from"./trophy-D8agcnr9.js";import{L as Q}from"./lightbulb-ZFvDqHVp.js";import{R as B}from"./rotate-ccw-BQdMKeUh.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=T("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=T("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=T("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=T("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=T("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),ge=[{name:"Google",roles:["SWE L3","SWE L4","SRE","Data Engineer"],categories:["Technical","Coding","Behavioral"]},{name:"Amazon",roles:["SDE 1","SDE 2","Solutions Architect"],categories:["Technical","Coding","Behavioral"]},{name:"Microsoft",roles:["SWE","Senior SWE","Program Manager"],categories:["Technical","Coding","HR"]},{name:"Meta",roles:["E3","E4","E5"],categories:["Technical","Coding","Behavioral"]},{name:"Apple",roles:["ICT2","ICT3","Software Engineer"],categories:["Technical","Coding","Behavioral"]},{name:"Netflix",roles:["Senior Software Engineer","Staff Engineer"],categories:["Technical","Coding","Behavioral"]},{name:"Infosys",roles:["Systems Engineer","Senior Systems Engineer","Technology Lead"],categories:["Technical","HR","Aptitude"]},{name:"TCS",roles:["Assistant Systems Engineer","Systems Engineer","IT Analyst"],categories:["Technical","HR","Aptitude"]},{name:"Wipro",roles:["Project Engineer","Senior Project Engineer"],categories:["Technical","HR","Aptitude"]},{name:"Cognizant",roles:["Programmer Analyst","Associate","Senior Associate"],categories:["Technical","HR","Aptitude"]}],pe=["Frontend Development","Backend Development","Full Stack Development","Mobile Development","Data Science","Machine Learning","DevOps","Cloud Engineering","QA/Testing","Database Administration","Security Engineering","Blockchain"],fe=[10,15,20,25,30,35,40];class H{async selectQuestionsForInterview(t,r,e=10){const n=Math.ceil(e*.6),i=await this.getPreviouslyAskedQuestionIds(r.user_id,t),a=await this.selectDatabaseQuestions(t,r,n,e,new Set(i)),o=Math.max(0,e-a.length),d=await this.generateAIQuestions(t,r,o),p=[...a,...d];return this.shuffleQuestions(p)}async selectDatabaseQuestions(t,r,e,n,i){const a=this.getCategoriesForConfig(t),o=this.getDesiredCategoryMix(t,r,n),d=[],p=[];for(const h of a){const c=o[h]?Math.min(o[h],e-d.length):0;if(c<=0)continue;let x=k.from("interview_questions").select("*").eq("is_active",!0).eq("is_dynamic",!1).eq("category",h);if(t.companyName){const b=t.targetRole?`,role.eq.${t.targetRole}`:"";x=x.or(`interview_type.eq.general,and(interview_type.eq.company-specific,company_name.eq.${t.companyName}${b})`)}else x=x.eq("interview_type","general");const{data:v,error:j}=await x;if(j||!v||v.length===0)continue;const u=v.filter(b=>!i.has(b.id)),m=(u.length>0?u:v).map(b=>({question:b,score:this.calculateRelevanceScore(b,r)}));m.sort((b,S)=>S.score-b.score);const y=m.slice(0,c).map(b=>b.question);if(d.push(...y),p.push(...m.slice(c)),d.length>=e)break}if(d.length<e){p.sort((c,x)=>x.score-c.score);const h=e-d.length;d.push(...p.slice(0,h).map(c=>c.question))}return d}calculateRelevanceScore(t,r){var x,v,j,u;let e=0;const n=t.question_text.toLowerCase(),i=(r.skills_detected||[]).map(l=>l.toLowerCase()),a=(((x=r.parsed_data)==null?void 0:x.projects)||[]).flatMap(l=>(l.technologies||[]).map(m=>m.toLowerCase())),o=(((v=r.parsed_data)==null?void 0:v.work_experience)||[]).flatMap(l=>(l.technologies||[]).map(m=>m.toLowerCase()));for(const l of i)n.includes(l)&&(e+=10);for(const l of a)n.includes(l)&&(e+=6);for(const l of o)n.includes(l)&&(e+=4);t.category==="Projects"&&(((u=(j=r.parsed_data)==null?void 0:j.projects)==null?void 0:u.length)||0)>0&&(e+=8),t.difficulty==="Easy"?e+=1:t.difficulty==="Medium"?e+=2:t.difficulty==="Hard"&&(e+=3);const d={entry:1,junior:2,mid:3,senior:4,lead:5,executive:6},p={Easy:1,Medium:2,Hard:3},h=d[r.experience_level||"junior"]||2,c=p[t.difficulty]||2;return Math.abs(h-c)<=1&&(e+=5),e+Math.random()*2}getDesiredCategoryMix(t,r,e){var d,p;const n=this.getCategoriesForConfig(t),i={Technical:0,HR:0,Behavioral:0,Coding:0,Projects:0};t.interviewCategory==="technical"?(i.Technical=Math.round(e*.5),i.Coding=Math.round(e*.3),i.Projects=Math.max(1,e-(i.Technical+i.Coding))):t.interviewCategory==="hr"?(i.HR=Math.round(e*.6),i.Behavioral=e-i.HR):(i.Technical=Math.round(e*.4),i.Coding=Math.round(e*.2),i.Behavioral=Math.max(1,Math.round(e*.15)),i.HR=Math.max(1,Math.round(e*.15)),i.Projects=Math.max(1,e-(i.Technical+i.Coding+i.Behavioral+i.HR))),(((p=(d=r.parsed_data)==null?void 0:d.projects)==null?void 0:p.length)||0)>0||(i.Technical+=i.Projects,i.Projects=0);for(const h of Object.keys(i))n.includes(h)||(i[h]=0);const o=Object.values(i).reduce((h,c)=>h+c,0);if(o>e){const h=e/o;Object.keys(i).forEach(x=>{i[x]=Math.floor(i[x]*h)});let c=e-Object.values(i).reduce((x,v)=>x+v,0);for(const x of["Technical","Coding","Behavioral","HR","Projects"]){if(c<=0)break;n.includes(x)&&(i[x]+=1,c--)}}return i}async getPreviouslyAskedQuestionIds(t,r){try{let e=k.from("mock_interview_sessions").select("id, company_name, target_role, interview_category, session_type").eq("user_id",t).order("started_at",{ascending:!1}).limit(10);const{data:n,error:i}=await e;if(i||!n||n.length===0)return[];const a=n.filter(c=>(r.companyName?c.company_name===r.companyName:!0)&&(r.targetRole?c.target_role===r.targetRole:!0)),o=(a.length>0?a:n).map(c=>c.id);if(o.length===0)return[];const{data:d,error:p}=await k.from("interview_responses").select("question_id").in("session_id",o).limit(500);return p||!d?[]:Array.from(new Set(d.map(c=>c.question_id).filter(Boolean)))}catch(e){return console.error("getPreviouslyAskedQuestionIds failed:",e),[]}}async generateAIQuestions(t,r,e){const n=[];for(let i=0;i<e;i++)try{const a=await this.generateSingleQuestion(t,r,i);a&&n.push(a)}catch(a){console.error(`Failed to generate question ${i+1}:`,a)}return n}async generateSingleQuestion(t,r,e){var a,o,d;const n={resume_id:r.id,user_id:r.user_id,skill_being_tested:r.skills_detected[e%r.skills_detected.length]||"general",experience_level:r.experience_level||"junior",specific_project:(d=(o=(a=r.parsed_data)==null?void 0:a.projects)==null?void 0:o[0])==null?void 0:d.name,specific_technology:r.skills_detected[0]},i=this.buildQuestionGenerationPrompt(t,r,n);try{const h=(await R.generateText(i)).replace(/```json\n?/g,"").replace(/```\n?/g,"").trim(),c=JSON.parse(h),{data:x,error:v}=await k.from("interview_questions").insert({question_text:c.question_text,category:this.mapToQuestionCategory(c.category),difficulty:c.difficulty,interview_type:t.companyName?"company-specific":"general",company_name:t.companyName,role:t.targetRole,is_active:!0,is_dynamic:!0,generated_for_user:r.user_id,resume_context:n}).select().single();return v||!x?(console.error("Failed to save generated question:",v),null):x}catch(p){return console.error("AI question generation failed:",p),null}}buildQuestionGenerationPrompt(t,r,e){var n,i;return`Generate a personalized interview question based on the candidate's resume.

Resume Information:
- Experience Level: ${r.experience_level}
- Years of Experience: ${r.years_of_experience||0}
- Key Skills: ${r.skills_detected.join(", ")}
- Domains: ${r.domains.join(", ")}
- Projects: ${((i=(n=r.parsed_data)==null?void 0:n.projects)==null?void 0:i.map(a=>a.name).join(", "))||"None listed"}

Interview Configuration:
- Type: ${t.sessionType}
- Category: ${t.interviewCategory}
- Company: ${t.companyName||"General"}
- Role: ${t.targetRole||"Software Engineer"}

Specific Context for This Question:
- Testing Skill: ${e.skill_being_tested}
- Specific Project: ${e.specific_project||"N/A"}
- Technology Focus: ${e.specific_technology||"N/A"}

Generate ONE interview question that:
1. Tests the candidate's knowledge of "${e.skill_being_tested}"
2. Is appropriate for ${r.experience_level} level candidates
3. References their specific experience or projects when relevant
4. Feels natural and conversational
5. Has clear evaluation criteria

Return a JSON object with this structure:
{
  "question_text": "Your personalized question here",
  "category": "Technical|HR|Behavioral|Coding|Projects",
  "difficulty": "Easy|Medium|Hard",
  "generation_rationale": "Why this question is relevant",
  "expected_topics": ["topic1", "topic2"],
  "resume_context": {}
}

IMPORTANT: Return ONLY the JSON object, no additional text.`}async generateFollowUpQuestion(t,r,e){const n=`Based on the candidate's answer, generate a relevant follow-up question.

Previous Question: ${t.question_text}

Candidate's Answer: ${r}

Resume Context:
- Skills: ${e.skills_detected.join(", ")}
- Experience Level: ${e.experience_level}

Generate a follow-up question that:
1. Probes deeper into their answer
2. Validates their claimed skills
3. Is appropriate for their experience level
4. Feels like a natural conversation

Return JSON with: {"question_text": "...", "category": "...", "difficulty": "...", "generation_rationale": "...", "expected_topics": []}`;try{const a=(await R.generateText(n)).replace(/```json\n?/g,"").replace(/```\n?/g,"").trim(),o=JSON.parse(a),{data:d,error:p}=await k.from("interview_questions").insert({question_text:o.question_text,category:this.mapToQuestionCategory(o.category),difficulty:o.difficulty,interview_type:"general",is_active:!0,is_dynamic:!0,generated_for_user:e.user_id,source_question_id:t.id,resume_context:{resume_id:e.id,user_id:e.user_id,skill_being_tested:"follow-up",experience_level:e.experience_level||"junior",previous_answers:[r]}}).select().single();return p||!d?null:d}catch(i){return console.error("Follow-up question generation failed:",i),null}}getCategoriesForConfig(t){return t.interviewCategory==="technical"?["Technical","Coding","Projects"]:t.interviewCategory==="hr"?["HR","Behavioral"]:["Technical","HR","Behavioral","Coding","Projects"]}getDifficultyForExperience(t){switch(t){case"entry":case"junior":return["Easy","Medium"];case"mid":return["Medium","Hard"];case"senior":case"lead":case"executive":return["Medium","Hard"];default:return["Easy","Medium","Hard"]}}mapToQuestionCategory(t){const r=t.toLowerCase();return r.includes("tech")?"Technical":r.includes("hr")?"HR":r.includes("behavior")?"Behavioral":r.includes("cod")?"Coding":r.includes("project")?"Projects":"Technical"}shuffleQuestions(t){const r=[...t];for(let e=r.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[r[e],r[n]]=[r[n],r[e]]}return r}}const z=new H;class V{async getQuestionsByCategory(t,r=10,e){let n=k.from("interview_questions").select("*").eq("is_active",!0).eq("category",t);e?n=n.or(`interview_type.eq.general,and(interview_type.eq.company-specific,company_name.eq.${e})`):n=n.eq("interview_type","general");const{data:i,error:a}=await n.limit(r);if(a)throw console.error("Error fetching interview questions:",a),new Error(`Failed to fetch interview questions: ${a.message}`);return i||[]}async getMixedQuestions(t,r=10,e,n,i){if(n&&i)return await z.selectQuestionsForInterview(i,n,r);const a=Math.ceil(r/t.length),o=[];for(const d of t){const p=await this.getQuestionsByCategory(d,a,e);o.push(...p)}return o.slice(0,r)}async createSession(t,r,e){const n={user_id:r,session_type:t.sessionType,interview_category:t.interviewCategory,company_name:t.companyName,target_role:t.targetRole,domain:t.domain,duration_minutes:t.durationMinutes,status:"in_progress",started_at:new Date().toISOString(),resume_id:e==null?void 0:e.id,question_generation_mode:e?"hybrid":"database_only",database_questions_count:0,ai_generated_questions_count:0},{data:i,error:a}=await k.from("mock_interview_sessions").insert(n).select().single();if(a)throw console.error("Error creating interview session:",a),new Error(`Failed to create interview session: ${a.message}`);return i}async getSession(t){const{data:r,error:e}=await k.from("mock_interview_sessions").select("*").eq("id",t).maybeSingle();if(e)throw console.error("Error fetching interview session:",e),new Error(`Failed to fetch interview session: ${e.message}`);return r}async getSessionWithDetails(t){const r=await this.getSession(t);if(!r)return null;const{data:e,error:n}=await k.from("interview_responses").select(`
        *,
        question:interview_questions(*)
      `).eq("session_id",t).order("question_order",{ascending:!0});if(n)throw console.error("Error fetching interview responses:",n),new Error(`Failed to fetch interview responses: ${n.message}`);const i=(e==null?void 0:e.map(o=>o.question).filter(Boolean))||[],a=(e==null?void 0:e.map(o=>{const{question:d,...p}=o;return p}))||[];return{...r,questions:i,responses:a}}async getUserSessions(t,r=20){const{data:e,error:n}=await k.from("mock_interview_sessions").select("*").eq("user_id",t).order("started_at",{ascending:!1}).limit(r);if(n)throw console.error("Error fetching user sessions:",n),new Error(`Failed to fetch user sessions: ${n.message}`);return e||[]}async saveResponse(t,r,e,n){const i={session_id:t,question_id:r,question_order:e,user_answer_text:n.userAnswerText,audio_url:n.audioUrl,video_url:n.videoUrl,audio_transcript:n.audioTranscript,ai_feedback_json:n.aiFeedback,individual_score:n.individualScore,tone_rating:n.toneRating,confidence_rating:n.confidenceRating,response_duration_seconds:n.responseDuration,resume_relevance_score:n.resumeRelevanceScore,validates_resume_claim:n.validatesResumeClaim,resume_skill_validated:n.resumeSkillValidated,credibility_score:n.credibilityScore},{data:a,error:o}=await k.from("interview_responses").upsert(i,{onConflict:"session_id,question_order"}).select().single();if(o)throw console.error("Error saving interview response:",o),new Error(`Failed to save interview response: ${o.message}`);return a}async updateSessionStatus(t,r,e,n){const i={status:r,updated_at:new Date().toISOString()};e!==void 0&&(i.overall_score=e),n!==void 0&&(i.actual_duration_seconds=n),r==="completed"&&(i.completed_at=new Date().toISOString());const{error:a}=await k.from("mock_interview_sessions").update(i).eq("id",t);if(a)throw console.error("Error updating session status:",a),new Error(`Failed to update session status: ${a.message}`)}async uploadRecording(t,r,e,n,i){const o=`${t}/${r}/q${e}_${i}.${i==="audio"?"webm":"mp4"}`,{error:d}=await k.storage.from("interview-recordings").upload(o,n,{contentType:i==="audio"?"audio/webm":"video/mp4",upsert:!0});if(d)throw console.error("Error uploading recording:",d),new Error(`Failed to upload recording: ${d.message}`);const{data:p}=k.storage.from("interview-recordings").getPublicUrl(o);return p.publicUrl}async getSessionResponses(t){const{data:r,error:e}=await k.from("interview_responses").select("*").eq("session_id",t).order("question_order",{ascending:!0});if(e)throw console.error("Error fetching session responses:",e),new Error(`Failed to fetch session responses: ${e.message}`);return r||[]}async calculateOverallScore(t){const r=await this.getSessionResponses(t);if(r.length===0)return 0;const e=r.reduce((n,i)=>n+(i.individual_score||0),0);return Math.round(e/r.length*10)}async updateSessionWithSecurity(t,r,e,n,i){const a=this.calculateSecurityScore(i.tabSwitchCount,i.fullScreenExits,i.totalViolationTime),o={status:r,overall_score:e,actual_duration_seconds:n,tab_switches_count:i.tabSwitchCount,fullscreen_exits_count:i.fullScreenExits,total_violation_time:i.totalViolationTime,violations_log:i.violationsLog,security_score:a,updated_at:new Date().toISOString()};r==="completed"&&(o.completed_at=new Date().toISOString());const{error:d}=await k.from("mock_interview_sessions").update(o).eq("id",t);if(d)throw console.error("Error updating session with security data:",d),new Error(`Failed to update session with security data: ${d.message}`)}calculateSecurityScore(t,r,e){let n=100;return n-=t*5,n-=r*10,n-=Math.floor(e/10)*2,Math.max(0,Math.min(100,n))}}const W=new V;console.log("InterviewFeedbackService: Using EdenAI for text generation");class G{async callEdenAI(t){return L.generateTextWithRetry(t,{temperature:.3,maxTokens:2e3})}async analyzeTechnicalAnswer(t,r,e="Medium"){const n=`You are an expert technical interviewer conducting a mock interview evaluation. Analyze the candidate's answer and provide structured feedback in JSON format.

QUESTION (${e} difficulty):
${t}

CANDIDATE'S ANSWER:
${r}

Provide your evaluation as a JSON object with the following structure:
{
  "score": <number from 0-10>,
  "missed_points": [<array of key concepts or details the candidate missed>],
  "suggestions": [<array of specific actionable suggestions to improve the answer>],
  "tone_confidence_rating": "<one of: Confident, Somewhat Confident, Nervous, Very Nervous, Professional>",
  "strengths": [<array of things the candidate did well>],
  "improvement_areas": [<array of areas needing improvement>]
}

SCORING CRITERIA:
- 9-10: Excellent answer with deep understanding, clear explanation, and relevant examples
- 7-8: Good answer covering main concepts with minor gaps
- 5-6: Satisfactory answer with significant gaps or unclear explanations
- 3-4: Poor answer missing key concepts or containing inaccuracies
- 0-2: Very poor answer showing fundamental misunderstanding

Be constructive, specific, and encouraging in your feedback. Focus on both what was done well and what could be improved.`;try{const a=(await this.callOpenRouter(n)).replace(/```json/g,"").replace(/```/g,"").trim(),o=JSON.parse(a);return(typeof o.score!="number"||o.score<0||o.score>10)&&(o.score=5),o}catch(i){return console.error("Error parsing AI feedback:",i),this.getFallbackFeedback()}}async analyzeHRAnswer(t,r){const e=`You are an experienced HR interviewer conducting a mock interview evaluation. Analyze the candidate's answer and provide structured feedback in JSON format.

QUESTION:
${t}

CANDIDATE'S ANSWER:
${r}

Provide your evaluation as a JSON object with the following structure:
{
  "score": <number from 0-10>,
  "missed_points": [<array of important points or examples the candidate should have mentioned>],
  "suggestions": [<array of specific suggestions to improve communication, structure, or content>],
  "tone_confidence_rating": "<one of: Confident and Professional, Confident, Somewhat Confident, Nervous, Very Nervous>",
  "strengths": [<array of positive aspects like clarity, examples, enthusiasm, structure>],
  "improvement_areas": [<array of areas like body language cues detected in text, answer structure, depth, relevance>]
}

SCORING CRITERIA:
- 9-10: Outstanding answer with clear structure, relevant examples, and strong communication
- 7-8: Good answer with solid examples and good communication
- 5-6: Adequate answer but lacking depth, structure, or specific examples
- 3-4: Weak answer with vague responses or poor structure
- 0-2: Very poor answer that doesn't address the question

Evaluate based on:
- Relevance and directness of the answer
- Use of specific examples and achievements
- Structure and clarity of communication
- Professionalism and enthusiasm
- Self-awareness and honesty

Be encouraging and provide actionable feedback.`;try{const i=(await this.callOpenRouter(e)).replace(/```json/g,"").replace(/```/g,"").trim(),a=JSON.parse(i);return(typeof a.score!="number"||a.score<0||a.score>10)&&(a.score=5),a}catch(n){return console.error("Error parsing AI feedback:",n),this.getFallbackFeedback()}}async analyzeBehavioralAnswer(t,r){const e=`You are a behavioral interview expert conducting a mock interview evaluation using the STAR method (Situation, Task, Action, Result). Analyze the candidate's answer and provide structured feedback in JSON format.

QUESTION:
${t}

CANDIDATE'S ANSWER:
${r}

Provide your evaluation as a JSON object with the following structure:
{
  "score": <number from 0-10>,
  "missed_points": [<array of STAR components missing or underdeveloped>],
  "suggestions": [<array of specific suggestions to improve the STAR structure and impact>],
  "tone_confidence_rating": "<one of: Confident and Articulate, Confident, Somewhat Confident, Nervous, Very Nervous>",
  "strengths": [<array of well-presented STAR elements or compelling story aspects>],
  "improvement_areas": [<array of areas to strengthen the narrative, add metrics, or clarify impact>]
}

SCORING CRITERIA (STAR Method):
- 9-10: Complete STAR with clear situation, specific actions, and measurable results
- 7-8: Good STAR coverage with most elements well-explained
- 5-6: Partial STAR with missing elements or vague descriptions
- 3-4: Incomplete STAR or overly generic response
- 0-2: No clear STAR structure or irrelevant answer

Evaluate specifically for:
- Situation: Was context clearly established?
- Task: Was their responsibility/challenge defined?
- Action: Were specific actions taken described?
- Result: Were outcomes and impact quantified?

Provide feedback that helps them tell more compelling stories.`;try{const i=(await this.callOpenRouter(e)).replace(/```json/g,"").replace(/```/g,"").trim(),a=JSON.parse(i);return(typeof a.score!="number"||a.score<0||a.score>10)&&(a.score=5),a}catch(n){return console.error("Error parsing AI feedback:",n),this.getFallbackFeedback()}}async analyzeAnswer(t,r,e,n="Medium"){if(!r||r.trim().length<10)return{score:0,missed_points:["No substantial answer provided"],suggestions:["Please provide a more detailed response to the question"],tone_confidence_rating:"Unable to assess",strengths:[],improvement_areas:["Provide more detailed responses"]};switch(e){case"Technical":case"Coding":case"Projects":return this.analyzeTechnicalAnswer(t,r,n);case"Behavioral":return this.analyzeBehavioralAnswer(t,r);case"HR":case"Aptitude":default:return this.analyzeHRAnswer(t,r)}}getFallbackFeedback(){return{score:5,missed_points:["Unable to analyze answer due to technical issues"],suggestions:["Please try again or review your answer for completeness"],tone_confidence_rating:"Unable to assess",strengths:["Answer provided"],improvement_areas:["Technical issue prevented detailed analysis"]}}async generateOverallSummary(t){const r=t.flatMap(h=>h.feedback.strengths||[]),e=t.flatMap(h=>h.feedback.improvement_areas||[]),n=new Map,i=new Map;r.forEach(h=>{const c=h.toLowerCase();n.set(c,(n.get(c)||0)+1)}),e.forEach(h=>{const c=h.toLowerCase();i.set(c,(i.get(c)||0)+1)});const a=Array.from(n.entries()).sort((h,c)=>c[1]-h[1]).slice(0,3).map(([h])=>h),o=Array.from(i.entries()).sort((h,c)=>c[1]-h[1]).slice(0,3).map(([h])=>h),d=t.reduce((h,c)=>h+c.score,0)/t.length,p=[];return d>=7?p.push("Strong overall performance showing good preparation"):d>=5?p.push("Solid foundation with room for improvement"):p.push("Focus on fundamentals and practice more to build confidence"),a.length>0&&p.push(`Keep leveraging your strength in ${a[0]}`),o.length>0&&p.push(`Priority improvement area: ${o[0]}`),{overallStrengths:a,overallImprovements:o,keyTakeaways:p}}}const J=new G;class Y{constructor(){f(this,"recognition",null);f(this,"isListening",!1);f(this,"transcript","");f(this,"onTranscriptUpdate");f(this,"onEnd");f(this,"onError");f(this,"autoRestart",!1);f(this,"restartAttempts",0);f(this,"maxRestartAttempts",5);f(this,"baseRestartDelay",1e3);f(this,"consecutiveNetworkErrors",0);f(this,"lastErrorTime",0);f(this,"isRecovering",!1);if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new t,this.setupRecognition()}}setupRecognition(){this.recognition&&(this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.maxAlternatives=1,this.recognition.onresult=t=>{let r="",e="";for(let i=t.resultIndex;i<t.results.length;i++){const a=t.results[i][0].transcript;t.results[i].isFinal?e+=a+" ":r+=a}this.transcript+=e;const n=this.transcript+r;this.consecutiveNetworkErrors=0,this.restartAttempts=0,this.onTranscriptUpdate&&this.onTranscriptUpdate(n)},this.recognition.onerror=t=>{if(console.error("Speech recognition error:",t.error),t.error==="network"){this.consecutiveNetworkErrors++;const r=Date.now()-this.lastErrorTime;if(this.lastErrorTime=Date.now(),r<2e3&&this.consecutiveNetworkErrors>3){console.error("Too many consecutive network errors, stopping auto-restart"),this.autoRestart=!1,this.isRecovering=!1,this.onError&&this.onError("network-persistent-failure");return}if(this.autoRestart&&this.restartAttempts<this.maxRestartAttempts&&!this.isRecovering){this.isRecovering=!0,this.restartAttempts++;const e=this.baseRestartDelay*Math.pow(2,this.restartAttempts-1),i=Math.min(e,8e3);console.warn(`Network error in speech recognition. Retry ${this.restartAttempts}/${this.maxRestartAttempts} in ${i}ms...`),setTimeout(()=>{if(this.autoRestart&&!this.isListening)try{console.log(`Attempting speech recognition restart (${this.restartAttempts}/${this.maxRestartAttempts})`),this.recognition.start(),this.isListening=!0,this.isRecovering=!1}catch(a){console.error("Failed to restart speech recognition:",a),this.isRecovering=!1,this.onError&&this.restartAttempts>=this.maxRestartAttempts&&this.onError("network-restart-failed")}else this.isRecovering=!1},i)}else this.restartAttempts>=this.maxRestartAttempts&&(console.error("Max restart attempts reached for network errors"),this.autoRestart=!1,this.onError&&this.onError("network-max-retries-exceeded"))}else t.error==="not-allowed"||t.error==="service-not-allowed"?(this.autoRestart=!1,this.onError&&this.onError("microphone-permission-denied")):t.error==="aborted"?console.log("Speech recognition aborted (expected)"):this.onError&&this.onError(t.error)},this.recognition.onend=()=>{this.isListening=!1,this.autoRestart&&this.restartAttempts<this.maxRestartAttempts&&!this.isRecovering?(console.log("Speech recognition ended, attempting auto-restart..."),setTimeout(()=>{if(this.autoRestart&&!this.isListening)try{this.recognition.start(),this.isListening=!0,this.consecutiveNetworkErrors=0}catch(t){console.error("Failed to auto-restart speech recognition:",t),t.message&&t.message.includes("already started")&&(this.isListening=!0)}},300)):this.onEnd&&this.onEnd(this.transcript)})}isSupported(){return this.recognition!==null}async startListening(t,r,e,n=!0){if(!this.isSupported())throw new Error("Speech recognition is not supported in this browser");if(this.isListening){console.warn("Speech recognition is already listening");return}this.transcript="",this.onTranscriptUpdate=t,this.onEnd=r,this.onError=e,this.autoRestart=n,this.restartAttempts=0;try{this.recognition.start(),this.isListening=!0}catch(i){throw console.error("Error starting speech recognition:",i),i}}stopListening(){return this.isListening?(this.autoRestart=!1,this.recognition&&this.recognition.stop(),this.isListening=!1,this.transcript):this.transcript}getCurrentTranscript(){return this.transcript}reset(){this.transcript="",this.isListening=!1,this.autoRestart=!1,this.restartAttempts=0,this.consecutiveNetworkErrors=0,this.lastErrorTime=0,this.isRecovering=!1,this.onTranscriptUpdate=void 0,this.onEnd=void 0,this.onError=void 0}async transcribeAudioBlob(t){if(console.log("Audio blob transcription requested. Size:",t.size),t.size===0)throw new Error("Audio blob is empty");const r=this.getCurrentTranscript();return r&&r.trim().length>0?r:new Promise((e,n)=>{const i=new FileReader;i.onload=()=>{e(this.transcript||"Unable to transcribe audio. Please ensure microphone permission is granted.")},i.onerror=()=>{n(new Error("Failed to read audio blob"))},i.readAsArrayBuffer(t)})}}const xe=new Y;class K{constructor(){f(this,"synthesis",null);f(this,"utterance",null);f(this,"isSpeaking",!1);f(this,"isPaused",!1);f(this,"onSpeakingUpdate");"speechSynthesis"in window&&(this.synthesis=window.speechSynthesis)}isSupported(){return this.synthesis!==null}async speak(t,r,e){return this.isSupported()?(this.stop(),new Promise((n,i)=>{if(this.utterance=new SpeechSynthesisUtterance(t),this.onSpeakingUpdate=r,this.utterance.rate=(e==null?void 0:e.rate)||.9,this.utterance.pitch=(e==null?void 0:e.pitch)||1,this.utterance.volume=(e==null?void 0:e.volume)||1,e!=null&&e.voice)this.utterance.voice=e.voice;else{const o=this.synthesis.getVoices().find(d=>d.lang.startsWith("en")&&(d.name.includes("Google")||d.name.includes("Female")));o&&(this.utterance.voice=o)}this.utterance.onstart=()=>{this.isSpeaking=!0,this.onSpeakingUpdate&&this.onSpeakingUpdate(t,!0)},this.utterance.onend=()=>{this.isSpeaking=!1,this.onSpeakingUpdate&&this.onSpeakingUpdate(t,!1),n()},this.utterance.onerror=a=>{this.isSpeaking=!1,console.error("Speech synthesis error:",a),this.onSpeakingUpdate&&this.onSpeakingUpdate(t,!1),i(a)},this.synthesis.speak(this.utterance)})):(console.warn("Text-to-Speech is not supported in this browser"),Promise.resolve())}pause(){this.synthesis&&this.isSpeaking&&!this.isPaused&&(this.synthesis.pause(),this.isPaused=!0)}resume(){this.synthesis&&this.isSpeaking&&this.isPaused&&(this.synthesis.resume(),this.isPaused=!1)}stop(){this.synthesis&&(this.synthesis.cancel(),this.isSpeaking=!1,this.isPaused=!1)}getAvailableVoices(){return this.synthesis?this.synthesis.getVoices():[]}isCurrentlySpeaking(){return this.isSpeaking}isPausedState(){return this.isPaused}}const ye=new K;class X{constructor(){f(this,"audioContext",null);f(this,"analyser",null);f(this,"microphone",null);f(this,"silenceTimer",null);f(this,"checkInterval",null);f(this,"onSilenceCallback",null);f(this,"onSpeechCallback",null);f(this,"silenceThreshold",5e3);f(this,"volumeThreshold",-50);f(this,"lastSpeechTime",0);f(this,"isActive",!1);f(this,"currentSilenceDuration",0)}async initialize(t,r){try{this.silenceThreshold=(r==null?void 0:r.silenceThreshold)||5e3,this.volumeThreshold=(r==null?void 0:r.volumeThreshold)||-50,this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=512,this.analyser.smoothingTimeConstant=.8,this.microphone=this.audioContext.createMediaStreamSource(t),this.microphone.connect(this.analyser),this.lastSpeechTime=Date.now(),this.isActive=!0}catch(e){throw console.error("Failed to initialize speech activity detector:",e),e}}start(t,r){if(!this.isActive||!this.analyser){console.warn("Speech activity detector not initialized");return}this.onSilenceCallback=t,this.onSpeechCallback=r,this.lastSpeechTime=Date.now(),this.currentSilenceDuration=0,this.checkInterval=setInterval(()=>{this.checkAudioLevel()},100)}checkAudioLevel(){if(!this.analyser||!this.isActive)return;const t=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(t);const r=t.reduce((n,i)=>n+i)/t.length;if(20*Math.log10(r/255)>this.volumeThreshold)this.lastSpeechTime=Date.now(),this.currentSilenceDuration=0,this.onSpeechCallback&&this.onSpeechCallback(),this.silenceTimer&&(clearTimeout(this.silenceTimer),this.silenceTimer=null);else{const n=Date.now()-this.lastSpeechTime;this.currentSilenceDuration=Math.floor(n/1e3),n>=this.silenceThreshold&&!this.silenceTimer&&(this.silenceTimer=setTimeout(()=>{this.onSilenceCallback&&this.onSilenceCallback(this.currentSilenceDuration)},100))}}getCurrentSilenceDuration(){if(!this.isActive)return 0;const t=Date.now()-this.lastSpeechTime;return Math.floor(t/1e3)}resetSilenceTimer(){this.lastSpeechTime=Date.now(),this.currentSilenceDuration=0,this.silenceTimer&&(clearTimeout(this.silenceTimer),this.silenceTimer=null)}stop(){this.isActive=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.silenceTimer&&(clearTimeout(this.silenceTimer),this.silenceTimer=null)}cleanup(){this.stop(),this.microphone&&(this.microphone.disconnect(),this.microphone=null),this.analyser&&(this.analyser.disconnect(),this.analyser=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.onSilenceCallback=null,this.onSpeechCallback=null}isInitialized(){return this.isActive&&this.analyser!==null}}const ve=new X,we=(g={})=>{const[t,r]=w.useState(!1),[e,n]=w.useState(0),i=w.useCallback(async()=>{try{const o=document.documentElement;o.requestFullscreen?await o.requestFullscreen():o.webkitRequestFullscreen?await o.webkitRequestFullscreen():o.msRequestFullscreen&&await o.msRequestFullscreen()}catch(o){console.error("Failed to enter full-screen mode:",o)}},[]),a=w.useCallback(async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(o){console.error("Failed to exit full-screen mode:",o)}},[]);return w.useEffect(()=>{const o=()=>{const d=!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement);r(d),!d&&t&&(n(p=>p+1),g.onFullScreenExit&&g.onFullScreenExit(),g.onViolation&&g.onViolation("fullscreen_exit"))};return document.addEventListener("fullscreenchange",o),document.addEventListener("webkitfullscreenchange",o),document.addEventListener("msfullscreenchange",o),g.autoRequestFullScreen&&i(),()=>{document.removeEventListener("fullscreenchange",o),document.removeEventListener("webkitfullscreenchange",o),document.removeEventListener("msfullscreenchange",o)}},[t,g,i]),{isFullScreen:t,violations:e,requestFullScreen:i,exitFullScreen:a}},be=(g={})=>{const[t,r]=w.useState(!0),[e,n]=w.useState(!0),[i,a]=w.useState(0),[o,d]=w.useState(0),[p,h]=w.useState([]),c=w.useRef(null),x=w.useCallback(()=>{const u=document.hidden||document.visibilityState==="hidden";if(r(!u),u)c.current=Date.now(),a(l=>l+1),g.onTabSwitch&&g.onTabSwitch();else if(c.current){const l=Math.floor((Date.now()-c.current)/1e3);d(y=>y+l);const m={type:"tab_switch",timestamp:c.current,duration:l};h(y=>[...y,m]),g.onViolation&&g.onViolation("tab_switch",l),c.current=null}},[g]),v=w.useCallback(()=>{n(!1),c.current||(c.current=Date.now()),g.onWindowBlur&&g.onWindowBlur()},[g]),j=w.useCallback(()=>{if(n(!0),c.current){const u=Math.floor((Date.now()-c.current)/1e3);d(m=>m+u);const l={type:"window_blur",timestamp:c.current,duration:u};h(m=>[...m,l]),g.onViolation&&g.onViolation("window_blur",u),c.current=null}},[g]);return w.useEffect(()=>(document.addEventListener("visibilitychange",x),window.addEventListener("blur",v),window.addEventListener("focus",j),()=>{if(document.removeEventListener("visibilitychange",x),window.removeEventListener("blur",v),window.removeEventListener("focus",j),c.current){const u=Math.floor((Date.now()-c.current)/1e3);d(l=>l+u)}}),[x,v,j]),{isTabActive:t,isWindowFocused:e,tabSwitchCount:i,totalTimeAway:o,violations:p}},_e=({userName:g,timeRemaining:t,currentQuestionIndex:r,totalQuestions:e,isPaused:n,totalViolations:i,isFullScreen:a,onPause:o,onEnd:d,onEnterFullScreen:p})=>{const h=c=>{const x=Math.floor(c/60),v=c%60;return`${x}:${v.toString().padStart(2,"0")}`};return s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-dark-200 border-b border-dark-300 shadow-xl z-50",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:"PB"})}),s.jsx("span",{className:"text-gray-100 font-semibold text-sm",children:"PrimoBoost AI"})]})}),s.jsx("div",{className:"h-6 w-px bg-dark-300"}),s.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[s.jsx("div",{className:"flex items-center gap-2 text-gray-300",children:s.jsx("span",{className:"font-mono font-semibold",children:h(t)})}),s.jsx("div",{className:"h-4 w-px bg-dark-300"}),s.jsxs("div",{className:"text-gray-300",children:[s.jsx("span",{className:"font-semibold",children:r+1}),s.jsxs("span",{className:"text-gray-500",children:[" / ",e]})]}),i>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-4 w-px bg-dark-300"}),s.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[s.jsx(A,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs font-semibold",children:i})]})]}),!a&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-4 w-px bg-dark-300"}),s.jsxs("button",{onClick:p,className:"flex items-center gap-2 text-yellow-400 hover:text-yellow-300 transition-colors",title:"Enter Full-Screen",children:[s.jsx(U,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs",children:"Full-Screen"})]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:o,className:"p-2 hover:bg-dark-300 rounded-lg transition-colors",title:n?"Resume":"Pause",children:n?s.jsx($,{className:"w-5 h-5 text-gray-300"}):s.jsx(D,{className:"w-5 h-5 text-gray-300"})}),s.jsx("button",{onClick:d,className:"p-2 hover:bg-red-900/20 rounded-lg transition-colors",title:"End Interview",children:s.jsx(F,{className:"w-5 h-5 text-red-400"})})]})]})})})},ke=({sessionId:g,onRetake:t,onBackHome:r})=>{const[e,n]=w.useState(null),[i,a]=w.useState(null),[o,d]=w.useState(!0);w.useEffect(()=>{p()},[g]);const p=async()=>{try{if(!g||g===""){console.error("Invalid session ID provided"),d(!1),n(null);return}let u=await W.getSessionWithDetails(g);if(!u)try{const{data:l,error:m}=await k.from("realistic_interview_sessions").select("*").eq("id",g).maybeSingle();if(m)throw m;if(l){const{data:y,error:b}=await k.from("realistic_interview_responses").select("*").eq("session_id",g).order("question_number",{ascending:!0});if(b)throw b;const S=(y||[]).map((_,N)=>({id:`realistic-${N+1}`,question_text:_.question_text||`Question ${N+1}`,category:_.question_type||"Technical",difficulty:"Medium",interview_type:"general",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));u={id:l.id,user_id:l.user_id,session_type:l.session_type||"general",interview_category:l.interview_category||"mixed",duration_minutes:l.duration_minutes||Math.ceil((l.actual_duration_seconds||0)/60),actual_duration_seconds:l.actual_duration_seconds,overall_score:l.overall_score,status:l.status,started_at:l.started_at,completed_at:l.completed_at,created_at:l.created_at,updated_at:l.updated_at,tab_switches_count:l.tab_switches_count,fullscreen_exits_count:l.fullscreen_exits_count,total_violation_time:l.total_violation_time,violations_log:l.violations_log,security_score:l.security_score,questions:S,responses:(y||[]).map((_,N)=>{var E;return{id:_.id,session_id:_.session_id,question_id:((E=S[N])==null?void 0:E.id)||`realistic-${N+1}`,question_order:_.question_number||N+1,user_answer_text:_.answer_text||_.code_answer||"",audio_url:void 0,video_url:void 0,audio_transcript:void 0,ai_feedback_json:_.ai_feedback_json,individual_score:_.quality_score||_.score||0,tone_rating:void 0,confidence_rating:void 0,response_duration_seconds:_.time_spent_seconds||void 0,created_at:_.created_at,updated_at:_.updated_at}})}}}catch(l){console.error("Fallback realistic session lookup failed:",l)}if(!u){console.error("Session not found for ID:",g),d(!1),n(null);return}if(n(u),u.responses&&u.responses.length>0){const l=u.responses.filter(m=>m.ai_feedback_json&&m.user_answer_text).map(m=>{var y;return{question:((y=u.questions.find(b=>b.id===m.question_id))==null?void 0:y.question_text)||"",answer:m.user_answer_text||"",feedback:m.ai_feedback_json,score:m.individual_score||0}});if(l.length>0)try{const m=await J.generateOverallSummary(l);a(m)}catch(m){console.error("Error generating insights:",m)}}d(!1)}catch(u){console.error("Error loading session data:",u),d(!1),n(null)}},h=u=>{if(!u)return"N/A";const l=Math.floor(u/60),m=u%60;return`${l}m ${m}s`},c=u=>u>=8?"text-green-500":u>=6?"text-yellow-500":"text-red-500";if(o)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-dark-100 dark:via-dark-50 dark:to-dark-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-700 dark:text-gray-300",children:"Loading your interview results..."})]})});if(!e)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-dark-100 dark:via-dark-50 dark:to-dark-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-secondary-700 dark:text-gray-300",children:"Session data not found"}),s.jsx("button",{onClick:r,className:"mt-4 btn-primary",children:"Back to Home"})]})});const x=e.overall_score||0,v=e.responses.length,j=e.questions.length;return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-dark-100 dark:via-dark-50 dark:to-dark-100 py-12",children:s.jsx("div",{className:"max-w-5xl mx-auto px-4",children:s.jsxs("div",{className:"bg-white dark:bg-dark-200 rounded-2xl shadow-2xl overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-8 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Interview Complete!"}),s.jsx("p",{className:"text-blue-100",children:"Here's your detailed performance report"})]}),s.jsx(O,{className:"w-16 h-16 opacity-80"})]})}),s.jsxs("div",{className:"p-8",children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-8",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-4 text-center",children:[s.jsx("div",{className:`text-4xl font-bold mb-1 ${c(x)}`,children:x}),s.jsx("div",{className:"text-sm text-secondary-600 dark:text-gray-400",children:"Overall Score"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-xl p-4 text-center",children:[s.jsxs("div",{className:"text-4xl font-bold mb-1 text-secondary-900 dark:text-gray-100",children:[v,"/",j]}),s.jsx("div",{className:"text-sm text-secondary-600 dark:text-gray-400",children:"Questions Answered"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-4 text-center",children:[s.jsx("div",{className:"text-4xl font-bold mb-1 text-secondary-900 dark:text-gray-100",children:h(e.actual_duration_seconds)}),s.jsx("div",{className:"text-sm text-secondary-600 dark:text-gray-400",children:"Total Duration"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-xl p-4 text-center",children:[s.jsx("div",{className:"text-4xl font-bold mb-1 text-secondary-900 dark:text-gray-100",children:e.interview_category.toUpperCase()}),s.jsx("div",{className:"text-sm text-secondary-600 dark:text-gray-400",children:"Interview Type"})]})]}),i&&s.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(M,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),s.jsx("h3",{className:"font-bold text-secondary-900 dark:text-gray-100",children:"Key Strengths"})]}),s.jsx("ul",{className:"space-y-2",children:i.overallStrengths.slice(0,3).map((u,l)=>s.jsxs("li",{className:"flex items-start gap-2 text-secondary-700 dark:text-gray-300",children:[s.jsx("span",{className:"text-green-500 font-bold",children:"âœ“"}),s.jsx("span",{className:"capitalize",children:u})]},l))})]}),s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Q,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s.jsx("h3",{className:"font-bold text-secondary-900 dark:text-gray-100",children:"Areas to Improve"})]}),s.jsx("ul",{className:"space-y-2",children:i.overallImprovements.slice(0,3).map((u,l)=>s.jsxs("li",{className:"flex items-start gap-2 text-secondary-700 dark:text-gray-300",children:[s.jsx("span",{className:"text-blue-500 font-bold",children:"â†’"}),s.jsx("span",{className:"capitalize",children:u})]},l))})]})]}),i&&i.keyTakeaways.length>0&&s.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-6 mb-8",children:[s.jsx("h3",{className:"font-bold text-secondary-900 dark:text-gray-100 mb-4",children:"ðŸŽ¯ Key Takeaways"}),s.jsx("ul",{className:"space-y-2",children:i.keyTakeaways.map((u,l)=>s.jsxs("li",{className:"text-secondary-700 dark:text-gray-300",children:["â€¢ ",u]},l))})]}),(e.security_score!==void 0||e.tab_switches_count!==void 0||e.fullscreen_exits_count!==void 0)&&s.jsxs("div",{className:`rounded-xl p-6 mb-8 border ${(e.security_score||100)>=80?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":(e.security_score||100)>=60?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[(e.security_score||100)>=80?s.jsx(I,{className:"w-6 h-6 text-green-600 dark:text-green-400"}):s.jsx(A,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"}),s.jsx("h3",{className:"text-xl font-bold text-secondary-900 dark:text-gray-100",children:"Interview Integrity Report"})]}),s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white dark:bg-dark-200 rounded-lg p-4 text-center",children:[s.jsx("div",{className:`text-3xl font-bold mb-1 ${(e.security_score||100)>=80?"text-green-600 dark:text-green-400":(e.security_score||100)>=60?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:e.security_score||100}),s.jsx("div",{className:"text-xs text-secondary-600 dark:text-gray-400",children:"Security Score"})]}),s.jsxs("div",{className:"bg-white dark:bg-dark-200 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-3xl font-bold mb-1 text-secondary-900 dark:text-gray-100",children:e.tab_switches_count||0}),s.jsx("div",{className:"text-xs text-secondary-600 dark:text-gray-400",children:"Tab Switches"})]}),s.jsxs("div",{className:"bg-white dark:bg-dark-200 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-3xl font-bold mb-1 text-secondary-900 dark:text-gray-100",children:e.fullscreen_exits_count||0}),s.jsx("div",{className:"text-xs text-secondary-600 dark:text-gray-400",children:"Full-Screen Exits"})]}),s.jsxs("div",{className:"bg-white dark:bg-dark-200 rounded-lg p-4 text-center",children:[s.jsxs("div",{className:"text-3xl font-bold mb-1 text-secondary-900 dark:text-gray-100",children:[e.total_violation_time||0,"s"]}),s.jsx("div",{className:"text-xs text-secondary-600 dark:text-gray-400",children:"Time Away"})]})]}),s.jsx("div",{className:`rounded-lg p-4 ${(e.security_score||100)>=80?"bg-green-100 dark:bg-green-900/30":(e.security_score||100)>=60?"bg-yellow-100 dark:bg-yellow-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:s.jsx("p",{className:"text-sm text-secondary-700 dark:text-gray-300",children:(e.security_score||100)>=80?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"âœ“ Excellent!"})," You maintained excellent focus throughout the interview. No significant violations were detected."]}):(e.security_score||100)>=60?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"âš  Good Attempt!"})," Some minor distractions were detected. Try to stay more focused in future interviews for better results."]}):s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"âš  Attention Required!"})," Multiple violations were detected during the interview. This may affect the credibility of your results. Please ensure better focus in future attempts."]})})})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold text-secondary-900 dark:text-gray-100 mb-4",children:"Question-by-Question Breakdown"}),s.jsx("div",{className:"space-y-4",children:e.responses.map((u,l)=>{var b;const m=e.questions.find(S=>S.id===u.question_id),y=u.ai_feedback_json;return s.jsxs("div",{className:"bg-secondary-50 dark:bg-dark-300 rounded-xl p-6 border border-secondary-200 dark:border-dark-400",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsxs("span",{className:"bg-blue-500 text-white px-2 py-1 rounded text-sm font-semibold",children:["Q",l+1]}),(()=>{const S=[];return m!=null&&m.category&&S.push(String(m.category)),m!=null&&m.difficulty&&S.push(String(m.difficulty)),S.length>0?s.jsx("span",{className:"text-xs text-secondary-600 dark:text-gray-400",children:S.join(" â€¢ ")}):null})()]}),s.jsx("p",{className:"font-semibold text-secondary-900 dark:text-gray-100 mb-2",children:m==null?void 0:m.question_text})]}),s.jsxs("div",{className:`text-2xl font-bold ${c(u.individual_score||0)} ml-4`,children:[(b=u.individual_score)==null?void 0:b.toFixed(1),"/10"]})]}),y&&s.jsxs("div",{className:"space-y-3 mt-4",children:[y.strengths&&y.strengths.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-green-600 dark:text-green-400 mb-1",children:"âœ“ Strengths:"}),s.jsx("ul",{className:"text-sm text-secondary-700 dark:text-gray-300 ml-4 space-y-1",children:y.strengths.map((S,_)=>s.jsxs("li",{children:["â€¢ ",S]},_))})]}),y.suggestions&&y.suggestions.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400 mb-1",children:"ðŸ’¡ Suggestions:"}),s.jsx("ul",{className:"text-sm text-secondary-700 dark:text-gray-300 ml-4 space-y-1",children:y.suggestions.map((S,_)=>s.jsxs("li",{children:["â€¢ ",S]},_))})]}),y.tone_confidence_rating&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-secondary-600 dark:text-gray-400",children:"Tone & Confidence:"}),s.jsx("span",{className:"font-semibold text-secondary-900 dark:text-gray-100",children:y.tone_confidence_rating})]})]})]},u.id)})})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[s.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all shadow-lg",children:[s.jsx(B,{className:"w-5 h-5"}),"Retake Interview"]}),s.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-3 bg-secondary-200 dark:bg-dark-300 text-secondary-900 dark:text-gray-100 rounded-xl font-semibold hover:bg-secondary-300 dark:hover:bg-dark-400 transition-all",children:[s.jsx(P,{className:"w-5 h-5"}),"Back to Home"]})]})]})]})})})};export{fe as D,ke as I,ue as M,ge as P,_e as S,pe as T,me as V,be as a,xe as b,he as c,de as d,J as e,z as h,W as i,ve as s,ye as t,we as u};
