import{j as t,m as B}from"./vendor-motion-_XdJ9pBm.js";import{r as l}from"./vendor-react-B4msnGgW.js";import{a as c}from"./adminSessionService-BGVyJgNb.js";import{s as M}from"./sessionBookingService-DouAmnnK.js";import{c as U,U as E,C as f,L as j,n as P,h as T,q as A,N as I,_ as R}from"./index-BbSeE-q4.js";import{D as $}from"./dollar-sign-DGh0A-Eb.js";import{C as O}from"./chevron-left-Dbkualgq.js";import{C as V}from"./chevron-right-CPxmRku4.js";import{D as F}from"./download-DWlYtjQA.js";import{H}from"./hash-Cu1sPzkK.js";import"./vendor-pdf-B1igRwBP.js";import"./vendor-supabase-B_87WqdG.js";import"./vendor-forms-BxTF4-4_.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=U("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),z={"10:00-11:00":"10:00 AM - 11:00 AM","11:00-12:00":"11:00 AM - 12:00 PM","12:00-13:00":"12:00 PM - 1:00 PM","14:00-15:00":"2:00 PM - 3:00 PM","15:00-16:00":"3:00 PM - 4:00 PM"},oe=()=>{const[a,m]=l.useState(new Date().toISOString().split("T")[0]),[o,N]=l.useState(null),[i,v]=l.useState([]),[n,k]=l.useState(null),[w,x]=l.useState(!0),[g,u]=l.useState(null);l.useEffect(()=>{(async()=>{const s=await M.getActiveService();s&&N(s.id);const r=await c.getBookingStats();k(r)})()},[]),l.useEffect(()=>{o&&b()},[o,a]);const b=async()=>{if(!o)return;x(!0);const e=await c.getSlotsByDate(o,a);v(e),x(!1)},y=async(e,s)=>{if(!o||s==="booked")return;u(e);const r=s!=="blocked";await c.toggleSlotBlock(o,a,e,r),await b(),u(null)},S=async()=>{const e=a,s=a,r=await c.exportBookingsCSV(e,s),L=new Blob([r],{type:"text/csv"}),p=URL.createObjectURL(L),d=document.createElement("a");d.href=p,d.download=`bookings-${a}.csv`,d.click(),URL.revokeObjectURL(p)},h=e=>{const s=new Date(a+"T00:00:00");s.setDate(s.getDate()+e),m(s.toISOString().split("T")[0])},C=e=>new Date(e+"T00:00:00").toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),D=i.filter(e=>e.status==="booked").length,_=i.filter(e=>e.status==="available").length;return t.jsxs("div",{className:"space-y-6",children:[n&&t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Bookings",value:n.total_bookings,icon:t.jsx(E,{className:"w-5 h-5"}),color:"text-blue-400 bg-blue-500/10"},{label:"Confirmed",value:n.confirmed,icon:t.jsx(f,{className:"w-5 h-5"}),color:"text-emerald-400 bg-emerald-500/10"},{label:"Completed",value:n.completed,icon:t.jsx(f,{className:"w-5 h-5"}),color:"text-teal-400 bg-teal-500/10"},{label:"Revenue",value:`â‚¹${n.total_revenue.toLocaleString("en-IN")}`,icon:t.jsx($,{className:"w-5 h-5"}),color:"text-amber-400 bg-amber-500/10"}].map(e=>t.jsxs("div",{className:"bg-slate-800/40 border border-slate-700/40 rounded-xl p-4",children:[t.jsx("div",{className:`w-9 h-9 rounded-lg ${e.color} flex items-center justify-center mb-2`,children:e.icon}),t.jsx("p",{className:"text-white text-lg font-bold",children:e.value}),t.jsx("p",{className:"text-slate-400 text-xs",children:e.label})]},e.label))}),t.jsxs("div",{className:"flex items-center justify-between bg-slate-800/40 border border-slate-700/40 rounded-xl p-4",children:[t.jsx("button",{onClick:()=>h(-1),className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700/50 transition-colors",children:t.jsx(O,{className:"w-5 h-5"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-white font-semibold",children:C(a)}),t.jsxs("p",{className:"text-slate-400 text-xs mt-0.5",children:[D," booked / ",_," available"]})]}),t.jsx("button",{onClick:()=>h(1),className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700/50 transition-colors",children:t.jsx(V,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"date",value:a,onChange:e=>m(e.target.value),className:"bg-slate-800/60 border border-slate-700 rounded-lg px-3 py-2 text-slate-200 text-sm focus:outline-none focus:ring-1 focus:ring-emerald-500/50"}),t.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-700 text-slate-300 text-sm font-medium hover:bg-slate-800/60 transition-colors",children:[t.jsx(F,{className:"w-4 h-4"}),"Export CSV"]})]}),w?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(j,{className:"w-6 h-6 text-emerald-400 animate-spin"})}):t.jsx("div",{className:"space-y-3",children:i.map((e,s)=>t.jsx(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:s*.05},className:`border rounded-xl p-4 ${e.status==="booked"?"bg-emerald-500/5 border-emerald-500/20":e.status==="blocked"?"bg-red-500/5 border-red-500/20":"bg-slate-800/30 border-slate-700/40"}`,children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-6",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-[160px]",children:[t.jsx(P,{className:"w-4 h-4 text-slate-400"}),t.jsx("span",{className:"text-white font-medium text-sm",children:z[e.time_slot]||e.time_slot})]}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium w-fit ${e.status==="booked"?"bg-emerald-500/10 text-emerald-400":e.status==="blocked"?"bg-red-500/10 text-red-400":"bg-slate-700/40 text-slate-400"}`,children:e.status==="booked"?"Booked":e.status==="blocked"?"Blocked":"Available"}),e.status==="booked"&&e.user_name&&t.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-slate-300",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(T,{className:"w-3.5 h-3.5 text-slate-500"}),e.user_name]}),e.user_email&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(A,{className:"w-3.5 h-3.5 text-slate-500"}),e.user_email]}),e.user_phone&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(I,{className:"w-3.5 h-3.5 text-slate-500"}),e.user_phone]}),e.booking_code&&t.jsxs("span",{className:"flex items-center gap-1 font-mono",children:[t.jsx(H,{className:"w-3.5 h-3.5 text-slate-500"}),e.booking_code]})]}),e.status!=="booked"&&t.jsx("button",{onClick:()=>y(e.time_slot,e.status),disabled:g===e.time_slot,className:`ml-auto flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${e.status==="blocked"?"bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20":"bg-red-500/10 text-red-400 hover:bg-red-500/20"} disabled:opacity-40`,children:g===e.time_slot?t.jsx(j,{className:"w-3.5 h-3.5 animate-spin"}):e.status==="blocked"?t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"w-3.5 h-3.5"}),"Unblock"]}):t.jsxs(t.Fragment,{children:[t.jsx(R,{className:"w-3.5 h-3.5"}),"Block"]})})]})},e.time_slot))})]})};export{oe as AdminSessionSchedule};
