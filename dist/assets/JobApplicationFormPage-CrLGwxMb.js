import{j as e}from"./vendor-motion-_XdJ9pBm.js";import{f as J,u as G,b as R,r as x}from"./vendor-react-B4msnGgW.js";import{u as B,L as P,a as Y,C as M,h as z,s as u}from"./index-BbSeE-q4.js";import{B as H}from"./Breadcrumb-CNnPIU0R.js";import{E as Q}from"./external-link-CSmvpDBS.js";import{G as W}from"./graduation-cap-C94epHPK.js";import{U as K}from"./upload-CurydzNZ.js";import{S as V}from"./send-BNy5p617.js";import"./vendor-pdf-B1igRwBP.js";import"./vendor-supabase-B_87WqdG.js";import"./vendor-forms-BxTF4-4_.js";import"./chevron-right-CPxmRku4.js";const ce=()=>{const{jobId:p}=J(),k=G();R();const{user:d,isAuthenticated:j}=B(),[l,L]=x.useState(null),[A,N]=x.useState(!0),[v,w]=x.useState(!1),[O,$]=x.useState(!1),[_,g]=x.useState(null),[t,F]=x.useState({fullName:"",email:"",phone:"",linkedinUrl:"",githubUrl:"",portfolioUrl:"",degree:"",institution:"",passedOutYear:"",completionDate:"",cgpa:"",companyName:"",jobTitle:"",experienceDuration:"",experienceDescription:"",whyGoodFit:"",expectedSalary:"",noticePeriod:"",availableToStart:"",resumeFile:null,coverLetterFile:null,agreeToTerms:!1}),[a,y]=x.useState({});x.useEffect(()=>{(async()=>{if(!p){g("Job ID is missing"),N(!1);return}try{const{data:s,error:n}=await u.from("job_listings").select("*").eq("id",p).single();if(n)throw n;if(L(s),j&&d){const{data:o}=await u.from("user_profiles").select("*").eq("user_id",d.id).single();o&&F(h=>{var c,f,m,b,U,D,S,T,E;return{...h,fullName:o.full_name||((c=d==null?void 0:d.user_metadata)==null?void 0:c.name)||"",email:d.email||"",phone:o.phone||"",linkedinUrl:o.linkedin_url||"",githubUrl:o.github_url||"",portfolioUrl:o.portfolio_url||"",degree:((m=(f=o.education_details)==null?void 0:f[0])==null?void 0:m.degree)||"",institution:((U=(b=o.education_details)==null?void 0:b[0])==null?void 0:U.institution)||"",passedOutYear:((S=(D=o.education_details)==null?void 0:D[0])==null?void 0:S.passed_out_year)||"",cgpa:((E=(T=o.education_details)==null?void 0:T[0])==null?void 0:E.cgpa)||""}})}}catch(s){console.error("Error fetching data:",s),g(s instanceof Error?s.message:"Failed to load")}finally{N(!1)}})()},[p,j,d]);const i=(r,s)=>{F(n=>({...n,[r]:s})),a[r]&&y(n=>({...n,[r]:""}))},C=(r,s)=>{if(s&&s.size>5*1024*1024){y(n=>({...n,[r]:"File size must be less than 5MB"}));return}i(r,s)},I=()=>{const r={};return t.fullName.trim()||(r.fullName="Full name is required"),t.email.trim()||(r.email="Email is required"),t.phone.trim()||(r.phone="Phone number is required"),t.degree.trim()||(r.degree="Degree is required"),t.institution.trim()||(r.institution="Institution is required"),t.passedOutYear.trim()||(r.passedOutYear="Passed-out year is required"),t.resumeFile||(r.resumeFile="Resume is required"),t.agreeToTerms||(r.agreeToTerms="You must agree to terms"),y(r),Object.keys(r).length===0},q=async r=>{if(r.preventDefault(),!I()){g("Please fill in all required fields");return}if(!d||!l){g("Missing user or job information");return}w(!0),g(null);try{let s="",n="";if(t.resumeFile){const c=`${d.id}/${Date.now()}_${t.resumeFile.name}`,{data:f,error:m}=await u.storage.from("resumes").upload(c,t.resumeFile);if(m)throw m;const{data:{publicUrl:b}}=u.storage.from("resumes").getPublicUrl(c);s=b}if(t.coverLetterFile){const c=`${d.id}/${Date.now()}_${t.coverLetterFile.name}`,{data:f,error:m}=await u.storage.from("cover-letters").upload(c,t.coverLetterFile);if(m)throw m;const{data:{publicUrl:b}}=u.storage.from("cover-letters").getPublicUrl(c);n=b}const o={user_id:d.id,job_listing_id:l.id,full_name:t.fullName,email:t.email,phone:t.phone,linkedin_url:t.linkedinUrl,github_url:t.githubUrl,portfolio_url:t.portfolioUrl,degree:t.degree,institution:t.institution,passed_out_year:parseInt(t.passedOutYear),completion_date:t.completionDate||null,cgpa:t.cgpa,company_name:t.companyName,job_title:t.jobTitle,experience_duration:t.experienceDuration,experience_description:t.experienceDescription,why_good_fit:t.whyGoodFit,expected_salary:t.expectedSalary,notice_period:t.noticePeriod,available_to_start:t.availableToStart,resume_file_url:s,cover_letter_url:n,application_method:"normal",status:"pending",applied_at:new Date().toISOString()},{error:h}=await u.from("job_applications").insert([o]);if(h)throw h;$(!0),setTimeout(()=>{k("/jobs/applications")},3e3)}catch(s){console.error("Error submitting application:",s),g(s instanceof Error?s.message:"Failed to submit application")}finally{w(!1)}};return A?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 flex items-center justify-center",children:e.jsx(P,{className:"w-12 h-12 animate-spin text-blue-600"})}):l?O?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(M,{className:"w-12 h-12 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Application Submitted!"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Your application for ",l.role_title," at ",l.company_name," has been successfully submitted."]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Redirecting to My Applications..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsx(H,{items:[{label:"Jobs",path:"/jobs"},{label:l.company_name,path:`/jobs/${p}/apply`},{label:"Application Form",path:void 0,isCurrentPage:!0}],className:"mb-6"}),e.jsx("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[l.company_logo_url?e.jsx("img",{src:l.company_logo_url,alt:l.company_name,className:"w-12 h-12 rounded-lg"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:l.company_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:l.role_title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:l.company_name})]})]}),l.application_link&&l.application_link.trim()!==""&&e.jsxs("a",{href:l.application_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 px-4 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors duration-200 text-sm font-medium",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Apply on Company Site"})]})]})}),e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center space-x-2",children:[e.jsx(z,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:"Personal Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.fullName,onChange:r=>i("fullName",r.target.value),className:`w-full px-4 py-3 rounded-xl border ${a.fullName?"border-red-500":"border-gray-300 dark:border-dark-300"} bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"John Doe"}),a.fullName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.fullName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:t.email,onChange:r=>i("email",r.target.value),className:`w-full px-4 py-3 rounded-xl border ${a.email?"border-red-500":"border-gray-300 dark:border-dark-300"} bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"john@example.com"}),a.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:t.phone,onChange:r=>i("phone",r.target.value),className:`w-full px-4 py-3 rounded-xl border ${a.phone?"border-red-500":"border-gray-300 dark:border-dark-300"} bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"+91 9876543210"}),a.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"LinkedIn URL"}),e.jsx("input",{type:"url",value:t.linkedinUrl,onChange:r=>i("linkedinUrl",r.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://linkedin.com/in/johndoe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"GitHub URL"}),e.jsx("input",{type:"url",value:t.githubUrl,onChange:r=>i("githubUrl",r.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://github.com/johndoe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Portfolio URL"}),e.jsx("input",{type:"url",value:t.portfolioUrl,onChange:r=>i("portfolioUrl",r.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://johndoe.com"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center space-x-2",children:[e.jsx(W,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:"Education"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Degree/Qualification ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.degree,onChange:r=>i("degree",r.target.value),className:`w-full px-4 py-3 rounded-xl border ${a.degree?"border-red-500":"border-gray-300 dark:border-dark-300"} bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"B.Tech in Computer Science"}),a.degree&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.degree})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Institution ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.institution,onChange:r=>i("institution",r.target.value),className:`w-full px-4 py-3 rounded-xl border ${a.institution?"border-red-500":"border-gray-300 dark:border-dark-300"} bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"University Name"}),a.institution&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.institution})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Passed-Out Year ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1980",max:"2030",value:t.passedOutYear,onChange:r=>i("passedOutYear",r.target.value),className:`w-full px-4 py-3 rounded-xl border ${a.passedOutYear?"border-red-500":"border-gray-300 dark:border-dark-300"} bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"2024"}),a.passedOutYear&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.passedOutYear})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Completion Date (MM/YYYY)"}),e.jsx("input",{type:"month",value:t.completionDate,onChange:r=>i("completionDate",r.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"CGPA/Percentage"}),e.jsx("input",{type:"text",value:t.cgpa,onChange:r=>i("cgpa",r.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"8.5 or 85%"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center space-x-2",children:[e.jsx(K,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:"Documents"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Resume ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:r=>{var s;return C("resumeFile",((s=r.target.files)==null?void 0:s[0])||null)},className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-600 hover:file:bg-blue-100"}),a.resumeFile&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.resumeFile}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"PDF or DOC format, max 5MB"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cover Letter (Optional)"}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:r=>{var s;return C("coverLetterFile",((s=r.target.files)==null?void 0:s[0])||null)},className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-600 hover:file:bg-blue-100"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-6",children:"Additional Information"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Why are you a good fit for this role?"}),e.jsx("textarea",{value:t.whyGoodFit,onChange:r=>i("whyGoodFit",r.target.value),rows:4,className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-dark-300 bg-white dark:bg-dark-200 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Describe your relevant skills and experience..."})]})})]}),_&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-500 rounded-xl p-4 flex items-center space-x-2",children:[e.jsx(Y,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:_})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-100 rounded-2xl shadow-xl p-8",children:[e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.agreeToTerms,onChange:r=>i("agreeToTerms",r.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:`text-sm ${a.agreeToTerms?"text-red-500":"text-gray-700 dark:text-gray-300"}`,children:["I agree to the terms and conditions and confirm that the information provided is accurate. ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),a.agreeToTerms&&e.jsx("p",{className:"text-red-500 text-sm mt-2 ml-8",children:a.agreeToTerms})]}),e.jsx("button",{type:"submit",disabled:v,className:"w-full py-4 px-6 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center space-x-3 disabled:opacity-50 disabled:cursor-not-allowed",children:v?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-6 h-6 animate-spin"}),e.jsx("span",{children:"Submitting Application..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-6 h-6"}),e.jsx("span",{children:"Submit Application"})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-dark-50 dark:to-dark-200 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Job Not Found"}),e.jsx("button",{onClick:()=>k("/jobs"),className:"mt-4 px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700",children:"Back to Jobs"})]})})};export{ce as JobApplicationFormPage};
